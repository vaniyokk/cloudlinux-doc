(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{179:function(e,t,s){"use strict";s.r(t);var r=s(0),a=Object(r.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),e._v(" "),s("p",[e._v("[ 0.8-32+]")]),e._v(" "),s("p",[e._v("is software to monitor and restrict MySQL usage in shared hosting environment. The monitoring is done via resource usage statistics per each MySQL thread.")]),e._v(" "),s("p",[e._v("can also kill off slow queries.")]),e._v(" "),s("p",[e._v("has multiple modes of operations, depending on the configuration. It can work in monitor only mode, or it can use different throttling scenarious.")]),e._v(" "),s("p",[e._v("allows to restrict customers who use too much resources. It supports following limits:")]),e._v(" "),e._m(1),e._v(" "),s("p",[e._v("You can set different limits for different periods: current, short, med, long. By default those periods are defined as 1 second, 5 seconds, 1 minute and 5 minutes. They can be re-defined using "),s("router-link",{attrs:{to:"/mysql_governor_configuration/"}},[e._v("configuration file")]),e._v(" . The idea is to use larger acceptable values for shorter periods. Like you could allow a customer to use two cores (200%) for one second, but only 1 core (on average) for 1 minute, and only 70% within 5 minutes. That would make sure that customer can burst for short periods of time.")],1),e._v(" "),s("p",[e._v("When customer is restricted, the customer will be placed into special LVE with ID 3. All restricted customers will be placed into that LVE, and you can control amount of resources available to restricted customers. Restricted customers will also be limited to only 30 concurrent connections. This is done so they wouldn't use up all the MySQL connections to the server.")]),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),s("p",[e._v("To install on your server install package at first:")]),e._v(" "),s("p",[e._v("Then configure properly.")]),e._v(" "),s("p",[e._v("The installation is currently supported only on , as well as on servers without control panel.")]),e._v(" "),s("p",[e._v("If you are installing on a server running MySQL already, set your current MySQL version before calling installation script:")]),e._v(" "),s("p",[e._v("Please make sure to specify your current MySQL version instead of XX as follows:")]),e._v(" "),s("p",[e._v("55 — MySQL v5.5\n56 — MySQL v5.6\n57 — MySQL v5.7")]),e._v(" "),s("p",[e._v("If you are installing on a server running already, do instead:")]),e._v(" "),s("p",[e._v("Please make sure to specify your current version instead of as follows:")]),e._v(" "),s("p",[e._v("55 — MariaDB v5.5\n100 — MariaDB v10.0\n101 — MariaDB v10.1\n102 — MariaDB v10.2\n103 — MariaDB v10.3")]),e._v(" "),s("p",[e._v("Installation for [requires 1.1-22+ or 1.2-21+]:")]),e._v(" "),s("p",[e._v("Please note that will be updated from repositories.")]),e._v(" "),s("p",[e._v("If you are installing on a server without MySQL at all, you have an opportunity to choose desired MySQL version to be installed with installation script. Use flag before calling the installation script:")]),e._v(" "),s("p",[e._v("could be chosen from the list of versions currently supported by :")]),e._v(" "),s("p",[e._v("Generally, and channels contain different version of MySQL packages - contains newer version than")]),e._v(" "),s("p",[e._v("Starting with version 1.2 when installing asks for a confirmation of a database version to be installed. To avoid such behavior for the automatic installations, please use flag.")]),e._v(" "),s("p",[e._v("For example:")]),e._v(" "),s("p",[e._v("Please note that restore of previous packages in case of failed installation would also be confirmed with flag.")]),e._v(" "),e._m(4),e._v(" "),s("p",[e._v("To remove :")]),e._v(" "),e._m(5),s("p",[e._v("The script will install original MySQL server, and remove .")]),e._v(" "),e._m(6),e._v(" "),e._m(7),e._v(" "),s("p",[e._v("has multiple modes of operation. Some of them are experimental at this moment.\nMode:\nIn this mode will not throttle customer's queries, instead it will let you monitor the MySQL usage to see the abusers at any given moment of time (and historically). This mode is good when you are just starting and want to see what is going on\nIn that mode once customer reaches the limits specified in the , all customer's queries will be running inside LVE with id 3. This means that when you have 5 customers restricted at the same time, all queries for all those 5 customers will be sharing same LVE. The larger the number of restricted customers - the less resources per restricted customer will be available\nIn that mode, once user goes over the limits specified in the , all customer's queries will execute inside that user's LVE. We believe this mode will help with the condition when the site is still fast, but MySQL is slow (restricted) for that user. If someone abuses MySQL, it will cause queries to share LVE with PHP processes, and PHP processes will also be throttled, causing less of a new queries being sent to MySQL. _Requires  _\nThis way there are no need for separate limits for MySQL. Depending on overhead we see in the future, we might decide to use it as a primary way of operating . The benefits of this approach is that limits are applied to both PHP & MySQL at the same time, all the time, preventing any spikes what so ever. _Requires _")]),e._v(" "),s("p",[e._v('If file is absent on the server, " " mode works emulate " ".')]),e._v(" "),s("p",[e._v("With and mode, once user is restricted, the queries for that user will be limited as long as user is using more than limits specified. After a minute that user is using less, we will unrestricted that user.")]),e._v(" "),s("p",[e._v("You can specify modes of operation using or by changing "),s("router-link",{attrs:{to:"/mysql_governor_configuration/"}},[e._v("configuration file")]),e._v(" .\nfile is located in")],1),e._v(" "),e._m(8),e._v(" "),s("p",[e._v("configuration is located in")]),e._v(" "),s("p",[e._v("It is best to modify it using tool.")]),e._v(" "),s("p",[e._v("Once configuration file is updated, please, restart the using:")]),e._v(" "),e._m(9),s("p",[e._v("Example configuration:")]),e._v(" "),e._m(10),e._m(11),e._m(12),e._v(" "),s("p",[e._v("To start:")]),e._v(" "),e._m(13),s("p",[e._v("To stop:")]),e._v(" "),e._m(14),e._m(15),e._v(" "),e._m(16),e._v(" "),s("p",[e._v("Traditionally used prefixes to map user to database. With the latest version, we automatically generate mapping for and control panels (other panels will follow).")]),e._v(" "),s("p",[e._v("The mapping file is located in:")]),e._v(" "),s("p",[e._v("The format of the file:")]),e._v(" "),e._m(17),s("p",[e._v("For example:")]),e._v(" "),e._m(18),s("p",[e._v("This would specify that db users: belong to user with uid (lve id)  502\ndb user belongs to user with uid 505, etc...")]),e._v(" "),s("p",[e._v("This file is checked for modifications every 5 minutes.")]),e._v(" "),s("p",[e._v("If you need to force reload of that file, run:")]),e._v(" "),e._m(19),e._m(20),e._v(" "),s("p",[e._v("error log is used to track any problems that might have")]),e._v(" "),s("p",[e._v("Restrict log is located in")]),e._v(" "),s("p",[e._v("Restrictions:")]),e._v(" "),e._m(21),s("p",[e._v("= load averages followed by output of\nis available with format\nis available with format")]),e._v(" "),e._m(22),e._v(" "),s("p",[e._v("If you would like to change to a different MySQL version, or switch to you have to start by backing up existing databases.")]),e._v(" "),e._m(23),e._m(24),e._v(" "),s("p",[e._v("To install beta version of MySQL:")]),e._v(" "),e._m(25),s("p",[e._v("can be one of the following:")]),e._v(" "),e._m(26),e._v(" "),e._m(27),e._v(" "),s("p",[e._v("MySQL Governor starting from version 1.2-36 (for now, July 4th, 2018 in Beta) supports MariaDB 10.3 installation.")]),e._v(" "),e._m(28),e._v(" "),s("p",[e._v("-- monitor MySQL usage on per user bases. More info...\n-- command line tool to manage\n-- provides historical information about usage and customer restrictions. "),s("router-link",{attrs:{to:"/dbgov_lveinfo/"}},[e._v("More info...")]),e._v("\n-- generate charts for MySQL usage. "),s("router-link",{attrs:{to:"/mysql_governor_dbgovchart/"}},[e._v("More info...")])],1),e._v(" "),e._m(29),e._v(" "),s("p",[e._v("Utility to monitor MySQL usage. Requires to be running. It shows usage for the current, mid and long intervals.")]),e._v(" "),s("p",[e._v("show one time user list (no interactive mode)\nrefresh interval for interactive mode (in seconds)")]),e._v(" "),s("p",[e._v("toggle color mode and two-color mode")]),e._v(" "),e._m(30),e._v(" "),s("p",[e._v("Control keys, that sort table, displays into header of table bold and underlined symbol.\nSorted field will be highlighted by *.\nfield shows current stage, reason for restriction and number of seconds before restriction will be lifted:\nValues of column ' ' - cause of restriction or freezing:\nPossible stages: - - , 1 - Restriction 1, 2 - Restriction 2, 3 - Restriction 3, 4 -- restriction level 4")]),e._v(" "),s("p",[e._v("(current value of parameter)\n(average value of 5 last values of parameter)\n(average value of 15 last values of parameter)\n(average value of 30 last values of parameter)\nand parameter which is cause of restriction")]),e._v(" "),e._m(31),e._v(" "),s("p",[e._v("Accounts highlighted in color means that the account is restricted.\nAccounts highlighted in color are in cool down period")]),e._v(" "),s("p",[e._v("Command line parameters of utility:\nrefresh period in seconds ( )")]),e._v(" "),e._m(32),e._v(" "),s("p",[e._v("usage:")]),e._v(" "),s("p",[e._v("set parameters for a\nlist users & their limits. It will list all users who had been active since restart,  as well as those for who explicit limits were set\nlist restricted customers, with their limits, restriction reason, and time period they will still be restricted\nignore particular user\nstart observing particular user again\nremove limits for user/use defaults\nrestrict user using lowest level (or if specified, using the specified level)\nunrestrict username (configuration file remains unchanged)\nunrestrict all restricted users (configuration file remains unchanged)\nshow this message\nversion number\nset mode of operation. Available values:")]),e._v(" "),e._m(33),e._v(" "),s("p",[e._v("set default parameter\nset parameter for user")]),e._v(" "),s("p",[e._v("limit (pct) usage\nlimit (MB/s) usage\nlimit (MB/s) usage\nlevel (1,2,3 or 4) specified (deprecated) - this option is available only for period mode:")]),e._v(" "),s("p",[e._v("(see http://docs.cloudlinux.com/index.html?mysql_governor_configuration.html)")]),e._v(" "),s("p",[e._v('The default mode is the " " - when a user hits limits, the account will be marked as restricted and if the user does not hit the limit again during " " account will be unrestricted. This mode doesn\'t have any additional levels/penalties.')]),e._v(" "),s("p",[e._v('Changing the "unlimit" can be done only via the configuration file (see '),s("a",{attrs:{href:"http://docs.cloudlinux.com/index.html?mysql_governor_configuration.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://docs.cloudlinux.com/index.html?mysql_governor_configuration.html"),s("OutboundLink")],1),e._v(" ).\nlimit time (in seconds) for long running queries")]),e._v(" "),s("p",[e._v("Options for parameter :")]),e._v(" "),s("p",[e._v("Examples:")]),e._v(" "),e._m(34),s("p",[e._v("sets individual limits for period) and periods) for user")]),e._v(" "),e._m(35),s("p",[e._v("changes default limits.")]),e._v(" "),s("p",[e._v("All new limits will be applied immediately")]),e._v(" "),s("p",[e._v("To unrestrict user:")]),e._v(" "),e._m(36),s("p",[e._v("To unrestrict all users:")]),e._v(" "),e._m(37),s("p",[e._v("To restrict user:")]),e._v(" "),e._m(38),s("p",[e._v("To restrict user to level 2 restriction:")]),e._v(" "),e._m(39),s("p",[e._v("To make to ignore user:")]),e._v(" "),e._m(40),s("p",[e._v("Delete user's limits, and use defaults instead:")]),e._v(" "),e._m(41),s("p",[e._v("Show limits as bytes:")]),e._v(" "),e._m(42),e._m(43),e._v(" "),s("p",[e._v("tool is a part of package. It was extended to collect historical information about MySQL usage.")]),e._v(" "),e._m(44),s("p",[e._v("Example:")]),e._v(" "),e._m(45),e._m(46),e._v(" "),s("p",[e._v("is analog of tool to create charts representing customer's to MySQL usage")]),e._v(" "),s("p",[e._v("Usage:")]),e._v(" "),s("p",[e._v("Acceptable options are:")]),e._v(" "),e._m(47),e._m(48),e._v(" "),e._m(49),e._v(" "),s("p",[e._v("On server disable MySQL service monitoring before doing the job:")]),e._v(" "),e._m(50),s("p",[e._v("Execute as :")]),e._v(" "),e._m(51),s("p",[e._v("On server enable monitoring back:")]),e._v(" "),e._m(52),e._m(53),e._v(" "),s("p",[e._v("We have created a plugin for tool to automatically upload core dumps in case crashes.")]),e._v(" "),s("p",[e._v("To install the plugin:")]),e._v(" "),e._m(54),s("p",[e._v("It will monitor crash reports for")]),e._v(" "),s("p",[e._v("You can modify to monitor other software as well by adding them to .")]),e._v(" "),e._m(55),e._m(56),e._v(" "),s("p",[e._v("and have only file for managing the service, but the file has functions, so it is supported by .")]),e._v(" "),s("p",[e._v("For adding extra limits, do the following:")]),e._v(" "),e._m(57),e._v(" "),e._m(58),e._m(59),e._v(" "),e._m(60),e._m(61),e._v(" "),e._m(62)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"mysql-governor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-governor","aria-hidden":"true"}},[this._v("#")]),this._v(" MySQL Governor")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",[s("thead",[s("tr",[s("th"),e._v(" "),s("th"),e._v(" "),s("th")])]),e._v(" "),s("tbody",[s("tr",[s("td"),e._v(" "),s("td",[e._v("%")]),e._v(" "),s("td",[e._v("speed relative to one core. 150% would mean one and a half cores")])]),e._v(" "),s("tr",[s("td"),e._v(" "),s("td",[e._v("bytes")]),e._v(" "),s("td",[e._v("bytes read. Cached reads are not counted, only those that were actually read from disk will be counted")])]),e._v(" "),s("tr",[s("td"),e._v(" "),s("td",[e._v("bytes")]),e._v(" "),s("td",[e._v("bytes written. Cached writes are not counted, only once data is written to disk, it is counted")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[this._v("#")]),this._v(" Installation")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("_ _")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"removing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#removing","aria-hidden":"true"}},[this._v("#")]),this._v(" Removing")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ /usr/share/lve/dbgovernor/mysqlgovernor.py --delete\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"modes-of-operation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#modes-of-operation","aria-hidden":"true"}},[this._v("#")]),this._v(" Modes Of Operation")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("[")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Configuration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ service db_governor restart\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('<governor>\n \n\x3c!--  \'off\' - do not throttle anything, monitoring only --\x3e\n\x3c!--  \'abusers\' - when user reaches the limit, put user\'s queries into LVE for that user --\x3e\n\x3c!--  \'all\' - user\'s queries always run inside LVE for that user --\x3e\n\x3c!--  \'single\' - single LVE=3 for all abusers. --\x3e\n\x3c!-- \'on\' - deprecated (old restriction type) --\x3e\n\x3c!-- To change resource usage of restricted user in LVE mode use command /usr/sbin/lvectl set 3 --cpu=<new value> --ncpu=<new value> --io=<new value> --        save-all-parameters --\x3e\n<lve use="on|single|off|abusers|all"/>\n \n\x3c!-- connection information --\x3e\n\x3c!-- If host, login and password are not present, this information is taken from /etc/my.cnf and ~root/.my.cnf --\x3e\n\x3c!-- Use symbol specified in prefix to figure out hosting accounts (mysql username will be split using prefix_separator, and first part will be used as account name). If prefix is not set, or empty -- don’t use prefixes/accounts --\x3e\n \n\x3c!-- db governor will try to split MySQL user names using prefix separator (if present)and statistics will be aggregated for the prefix (account name) --\x3e\n<connector host="..." login="..." password=".." prefix_separator="_"/>\n \n\x3c!-- Intervals define historical intervals for burstable limits. In seconds --\x3e\n<intervals short="5" mid="60" long="300"/>\n \n\x3c!-- log all errors/debug info into this log --\x3e\n<log file=”/var/log/dbgovernor-error.log” mode=”DEBUG|ERROR”/>\n \n\x3c!-- s -- seconds, m -- minutes, h -- hours, d -- days --\x3e\n\x3c!-- on restart, restrict will disappear --\x3e\n\x3c!-- log file will contain information about all restrictions that were take --\x3e\n\x3c!-- timeout - penalty period when user not restricted, but if he hit his limit during this period he will be restricted with higher level of restrict (for more long time) --        >\n<!- level1, level2, level3, level4 - period of restriction user for different level of restriction. During this period all user\'s requests will be placed into LVE container         --\x3e\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('\x3c!-- if user hits any of the limits during period of time specified in timeout, higher         level of restrict will be used to restrict user. If user was already on level4, level4         will be applied again --\x3e\n\x3c!-- attribute format set an restrict log format:\nSHORT -  restrict info only\nMEDIUM - restrict info, _all_tracked_values_\nLONG - restrict info, _all_tracked_values_, load average and vmstat info\nVERYLONG - restrict info, _all_tracked_values_, load average and vmstat info, slow query info --\x3e\n\x3c!-- script -- path to script to be triggered when account is restricted --\x3e\n\x3c!-- user_max_connections - The number of simultaneous connections of blocked user (in LVE mode) --\x3e\n \n\x3c!-- restriction levels/format are deprecated --\x3e\n<restrict level1="60s" level2="15m" level3="1h" level4="1d" timeout="1h"\nlog="/var/log/dbgovernor-restrict.log" format="SHORT|MEDIUM|LONG|VERYLONG"\nscript="/path/to/script"\nuser_max_connections="30"/>\n \n\x3c!-- period (deprecated) - period based restriction that has multiple levels (see above) --\x3e\n\x3c!-- limit (by default) - when user hits limits, the account will be marked as restricted and if user does not hit  limit again during "unlimit=1m" account will be unrestricted. This mode doesn\'t have any additional levels/penalties. --\x3e\n<restrict_mode use="period|limit" unlimit="1m"/>\n\n\x3c!-- killing slow SELECT queries (no other queries will be killed) --\x3e\n\x3c!-- if "log" attribute was set all killed queries will be saved in log file --\x3e\n\x3c!-- slow parameter in the <limit name="slow" current="30"/> will no be applied without enabling slow_queries --\x3e \n<slow_queries run="on|off" log="/var/log/dbgovernor-kill.log"/> \n\x3c!-- Enable or disable saving of statistics for lve-stats - On - enabled, Off-disabled --\x3e\n<statistic mode="on|off"></statistic>\n\x3c!-- Enable logging user queries on restrict, can be On or Off --\x3e\n\x3c!-- Files are saved in /var/lve/dbgovernor-store and being kept here during 10 days --        >\n<logqueries use="on|off"></logqueries>\n<default>\n\x3c!-- -1 not use limit(by default, current - required) --\x3e\n<limit name="cpu" current="150" short="100" mid="90" long="65"/>\n<limit name="read" current="100000000" short="90000000" mid="80000000" long="70000000"/>\n<limit name="write" current="100000000" short="90000000" mid="80000000" long="70000000"/>\n\x3c!-- Time to kill slow SELECT queries for account, can be different for accounts in seconds(but unit can be specified) --\x3e\n\x3c!-- enabled only when slow_queries run="on" --\x3e\n\x3c!-- s -- seconds, m -- minutes, h -- hours, d -- days --\x3e\n<limit name="slow" current="30"/>\n</default>\n\x3c!-- name will matched account name, as extracted via prefix extraction --\x3e\n \n\x3c!-- mysql_name will match exact MySQL user name. If both name and mysql_name are present, system will produce error --\x3e\n\x3c!-- mode restrict -- default mode, enforcing restrictions --\x3e\n\x3c!-- mode norestrict -- track usage, but don’t restrict user --\x3e \n\x3c!-- mode ignore -- don’t track and don’t restrict user --\x3e\n<user name=”xxx” mysql_name=”xxx” mode=”restrict|norestrict|ignore”>\n<limit...>\n</user>\n \n\x3c!-- debug mode for particular user. The information logged to restrict log. --\x3e\n<debug_user name="xxx"/>\n \n</governor>\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"starting-and-stopping"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#starting-and-stopping","aria-hidden":"true"}},[this._v("#")]),this._v(" Starting And Stopping")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ service db_governor start\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ service db_governor stop\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"mapping-a-user-to-database"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mapping-a-user-to-database","aria-hidden":"true"}},[this._v("#")]),this._v(" Mapping a User to Database")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("[")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("[dbuser_name1] [account_name1] [UID1]\n...\n[dbuser_nameN] [account_nameN] [UIDN]\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("pupkinas_u2 pupkinas 502\npupkinas_u1 pupkinas 502\npupkinas_u3 pupkinas 502\npupkin2a_uuu1 pupkin2a 505\npupkin10_p10 pupkin10 513\npupkin5a_u1 pupkin5a 508\npupkin3a_qq1 pupkin3a 506\npupkin3a_test22 pupkin3a 506\npupkin3a_12 pupkin3a 506\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("service db_governor restart\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"log-files"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#log-files","aria-hidden":"true"}},[this._v("#")]),this._v(" Log Files")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("_timestamp_ _username_ LIMIT_ENFORCED _limit_setting_ __current_value_                         _restrict_level__ SERVER_LOAD TRACKED_VALUES_DUMP \n... \n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"change-mysql-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#change-mysql-version","aria-hidden":"true"}},[this._v("#")]),this._v(" Change MySQL version")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ /usr/share/lve/dbgovernor/mysqlgovernor.py --mysql-version=MYSQL_VERSION\n$ /usr/share/lve/dbgovernor/mysqlgovernor.py --install\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("If you are using or -- recompile .")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ /usr/share/lve/dbgovernor/mysqlgovernor.py --install-beta\n")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",[s("thead",[s("tr",[s("th"),e._v(" "),s("th")])]),e._v(" "),s("tbody",[s("tr",[s("td"),e._v(" "),s("td",[e._v("default version of MySQL for given OS release (or cPanel settings)")])]),e._v(" "),s("tr",[s("td"),e._v(" "),s("td",[e._v("MySQL v5.0")])]),e._v(" "),s("tr",[s("td",[e._v("mysql51")]),e._v(" "),s("td",[e._v("MySQL v5.1")])]),e._v(" "),s("tr",[s("td",[e._v("mysql55")]),e._v(" "),s("td",[e._v("MySQL v5.5")])]),e._v(" "),s("tr",[s("td",[e._v("mysql56")]),e._v(" "),s("td",[e._v("MySQL v5.6")])]),e._v(" "),s("tr",[s("td",[e._v("mysql57")]),e._v(" "),s("td",[e._v("MySQL v5.7")])]),e._v(" "),s("tr",[s("td",[e._v("mariadb55")]),e._v(" "),s("td",[e._v("MariaDB v5.5")])]),e._v(" "),s("tr",[s("td",[e._v("mariadb100")]),e._v(" "),s("td",[e._v("MariaDB v10.0")])]),e._v(" "),s("tr",[s("td",[e._v("mariadb101")]),e._v(" "),s("td",[e._v("MariaDB v10.1")])]),e._v(" "),s("tr",[s("td",[e._v("mariadb102")]),e._v(" "),s("td",[e._v("MariaDB v 10.2")])]),e._v(" "),s("tr",[s("td",[e._v("mariadb103")]),e._v(" "),s("td",[e._v("MariaDB v 10.3")])]),e._v(" "),s("tr",[s("td",[e._v("percona56")]),e._v(" "),s("td",[e._v("Percona v 5.6")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("We don't recommend to downgrade from MySQL v5.6,")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"command-line-tools"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#command-line-tools","aria-hidden":"true"}},[this._v("#")]),this._v(" Command-line Tools")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"dbtop"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dbtop","aria-hidden":"true"}},[this._v("#")]),this._v(" dbtop")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("quit program\nsort table by username\nsort table by cpu column\nsort table by read column\nsort table by write column\nsort by restriction level\nsort by time before restrictions will be lifted.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("p",[this._v("first level restricted account with short average restriction with 12 seconds left before re-enabled.")])]),this._v(" "),t("li",[t("p",[this._v("number in %, shows usage by user\n· - number of bytes (kbytes, mbytes, gbytes) which user reads per second\n· - number of bytes (kbytes, mbytes, gbytes) write user reads per second")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"dbctl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dbctl","aria-hidden":"true"}},[this._v("#")]),this._v(" dbctl")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[e._v("monitor only, don't throttle")]),e._v(" "),s("li",[e._v("when user reaches the limit, put user's queries into LVE for that user (experimental)")]),e._v(" "),s("li",[e._v("user's queries always run inside LVE for that user (experimental)")]),e._v(" "),s("li",[e._v("single LVE for all abusers.")]),e._v(" "),s("li",[e._v("same as (deprecated)")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl set test2 --cpu=150,100,70,50 --read=2048,1500,1000,800\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl set default --cpu=70,60,50,40\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl unrestrict username\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl unrestrict-all \n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl restrict dbgov\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl restrict dbgov --level=2\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl ignore username\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ dbctl delete username\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$dbctl list --bb\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"lveinfo-dbgov"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lveinfo-dbgov","aria-hidden":"true"}},[this._v("#")]),this._v(" lveinfo --dbgov")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("Displays information about historical Db Governor usage\nUsage: lveinfo [OPTIONS]\n \n-h --help              : this help run report from date and time in YYYY-MM-DD HH:MM format if not present last 10 mscreen\n-v, --version          : version number\n-f, --from=            : inutes are assumed\n-t, --to=              : run report up to date and time in YYYY-MM-DD HH:MM format\n      if not present, reports results up to now\n    --period=          : time period\n      usage            : specify minutes with m,  h - hours, days with d, and values:\n                       : today, yesterday; 5m - last 5 minutes, 4h -- last four hours,\n                       : 2d - last 2 days, as well as today\n-o, --order-by=        : orders results by one of the following:\n      con              : average connections\n      cpu              : average CPU usage\n      read             : average READ usage\n      write            : average WRITE usage\n-u, --user=            : mysql username\n-l, --limit=           : max number of results to display, 10 by default\n-c, --csv              : display output in CSV format\n-b, --format           : show only specific fields into output\n      available values:\n      ts               : timestamp records\n      username         : user name\n      con              : average connections\n      cpu              : average CPU usage\n      read             : average READ usage\n      write            : average WRITE usage\n      lcpu             : CPU limit\n      lread            : READ limit\n      lwrite           : WRITE limit\n    --show-all         : full output (show all limits); brief output is default\n \n-o, --order-by=        : orders results by one of the following:\n      ts               : timestamp records\n      username         : user name\n      max_sim_req      : max simultaneous requests\n      sum_cpu          : average CPU usage\n      sum_write        : average WRITE usage\n      sum_read         : average READ usage\n      num_of_rest      : number of restricts\n      limit_cpu_end    : limit CPU on period end\n      limit_read_end   : limit READ on period end\n      limit_write_end  : limit WRITE on period end\n    --id=              : LVE id -- will display record only for that LVE id\n-u, --user=            : Use username instead of LVE id, and show only record for that\n                       : user\n-l, --limit=           : max number of results to display, 10 by default\n-c, --csv              : display output in CSV format\n-b, --by-usage         : show LVEs with usage (averaged or max) within 90% percent\n                       : of the limit\n      available values:\n      sum_cpu          : average CPU usage\n      sum_write        : average WRITE usage\n      sum_read         : average READ usage\n      num_of_rest      : number of restricts\n      limit_cpu_end    : limit CPU on period end\n      limit_read_end   : limit READ on period end\n      limit_write_end  : limit WRITE on period end\n    --show-all         : full output (show all limits); brief output is default\n \nTS                     : timestamp records\nUSER                   : user name\nCPU                    : average CPU usage\nREAD                   : average READ usage\nWRITE                  : average WRITE usage\nCON                    : average connections\nlCPU                   : CPU limit\nlREAD                  : READ limit\nlWRITE                 : WRITE limit\nRESTRICT               : C-cpu restrict, R- read restrict, W- write restrict\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("root@cpanel1 [~/ttttt]# lveinfo --dbgov --user=dbgov --period=1d --limit=10\nTS                   USER   CPU     READ    WRITE   CON     lCPU    lREAD   lWRITE   RESTRICT  \n2012-12-06 11:14:49  dbgov   9       0.0     0.0     1       90      1000    1000                \n2012-12-06 11:13:49  dbgov   9       0.0     0.0     1       90      1000    1000                \n2012-12-06 11:12:49  dbgov   9       0.0     0.0     1       90      1000    1000                \n2012-12-06 11:11:49  dbgov   9       0.0     0.0     1       90      1000    1000                \n2012-12-06 11:10:49  dbgov   9       0.0     0.0     1       90      1000    1000                \n2012-12-06 11:09:49  dbgov   90      0.0     0.0     1       90      1000    1000     C          \n2012-12-06 11:08:49  dbgov   0       0.0     0.0     0       400     1000    1000                \n2012-12-06 11:07:49  dbgov   0       0.0     0.0     0       400     1000    1000                \n2012-12-06 11:06:49  dbgov   0       0.0     0.0     0       400     1000    1000   \n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"dbgovchart"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dbgovchart","aria-hidden":"true"}},[this._v("#")]),this._v(" dbgovchart")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("--help      This help screen\n--version   Version number\n--from=     Run report from date and time in YYYY-MM-DD HH:MM format\n            if not present last 10 minutes are assumed\n--to=       Run report up to date and time in YYYY-MM-DD HH:MM format\n            if not present, reports results up to now\n--period=   Time period\n            specify minutes with m,  h - hours, days with d, and values:\n            today, yesterday\n            5m - last 5 minutes, 4h - last four hours, 2d - last 2 days,\n            as well as today\n--user=     mysql username\n--output=   Filename to save chart as, if not present, output will be sent to STDOUT\n--show-all  Show all graphs (by default shows graphs for which limits are set)\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Charts examples:\n"),t("img",{attrs:{src:"/images/1111.png",alt:""}}),this._v(" "),t("img",{attrs:{src:"/images/1111_2.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"backing-up-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#backing-up-mysql","aria-hidden":"true"}},[this._v("#")]),this._v(" Backing Up MySQL")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ whmapi1 configureservice service=mysql enabled=1 monitored=0\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ mkdir -p ~/mysqlbkp\n$ service mysql restart --skip-networking --skip-grant-tables\n$ mysql_upgrade\n$ mysqldump --all-databases --routines --triggers > ~/mysqlbkp/dbcopy.sql\n$ service mysql stop\n$ cp -r /var/lib/mysql/mysql ~/mysqlbkp/\n$ service mysql start\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ whmapi1 configureservice service=mysql enabled=1 monitored=1\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"abrt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#abrt","aria-hidden":"true"}},[this._v("#")]),this._v(" abrt")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ yum install cl-abrt-plugin --enablerepo=cloudlinux-updates-testing\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("AppLists=/usr/sbin/db_governor,/usr/sbin/dbtop,/usr/sbin/dbctl\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"troubleshooting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[this._v("#")]),this._v(" Troubleshooting")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ol",[t("li",[this._v("Run:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("mkdir /etc/systemd/system/mariadb.service.d/\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ol",{attrs:{start:"2"}},[t("li",[this._v("Run:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("touch /etc/systemd/system/mariadb.service.d/limits.conf\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ol",{attrs:{start:"3"}},[t("li",[this._v("Add the following content to the the file :")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("[Service] \nLimitNOFILE=99999\n")])])])}],!1,null,null,null);a.options.__file="README.md";t.default=a.exports}}]);