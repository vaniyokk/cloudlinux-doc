<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CageFS | Documentation</title>
    <meta name="description" content="Kernelcare documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.166b4f65.css" as="style"><link rel="preload" href="/assets/js/app.0abf6f2a.js" as="script"><link rel="preload" href="/assets/js/6.3f73b2ab.js" as="script"><link rel="prefetch" href="/assets/js/10.637ec29d.js"><link rel="prefetch" href="/assets/js/11.5bc4e224.js"><link rel="prefetch" href="/assets/js/12.86ab74a0.js"><link rel="prefetch" href="/assets/js/13.57ab5c71.js"><link rel="prefetch" href="/assets/js/14.fd3e69ee.js"><link rel="prefetch" href="/assets/js/15.ae08bd81.js"><link rel="prefetch" href="/assets/js/16.c78fdb9f.js"><link rel="prefetch" href="/assets/js/17.1fdd51cc.js"><link rel="prefetch" href="/assets/js/18.2e9e3c46.js"><link rel="prefetch" href="/assets/js/19.6a071eb7.js"><link rel="prefetch" href="/assets/js/20.03d7f633.js"><link rel="prefetch" href="/assets/js/21.c64caaaa.js"><link rel="prefetch" href="/assets/js/22.c03a1b94.js"><link rel="prefetch" href="/assets/js/23.a5cd9404.js"><link rel="prefetch" href="/assets/js/24.b90fb854.js"><link rel="prefetch" href="/assets/js/25.42c7c91b.js"><link rel="prefetch" href="/assets/js/26.159622d1.js"><link rel="prefetch" href="/assets/js/27.e8de38ef.js"><link rel="prefetch" href="/assets/js/28.ac2756db.js"><link rel="prefetch" href="/assets/js/3.5515951d.js"><link rel="prefetch" href="/assets/js/4.4d6450cb.js"><link rel="prefetch" href="/assets/js/5.90579adc.js"><link rel="prefetch" href="/assets/js/7.a073d98e.js"><link rel="prefetch" href="/assets/js/8.29039cd1.js"><link rel="prefetch" href="/assets/js/9.ef4b91a3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.28e1d2e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.166b4f65.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.com/trial" target="_blank" class="btn">
      Try Free
    </a> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Content</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloudlinux_installation/" class="sidebar-link">Installation</a></li><li><a href="/limits/" class="sidebar-link">Limits</a></li><li><a href="/lve_manager/" class="sidebar-link">LVE Manager</a></li><li><a href="/reseller_limits/" class="sidebar-link">Reseller Limits</a></li><li><a href="/lve-stats_2/" class="sidebar-link">LVE-Stats 2</a></li><li><a href="/cagefs/" class="active sidebar-link">CageFS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cagefs/#installation" class="sidebar-link">Installation</a></li><li class="sidebar-sub-header"><a href="/cagefs/#unistalling-cagefs" class="sidebar-link">Unistalling CageFS</a></li><li class="sidebar-sub-header"><a href="/cagefs/#managing-users" class="sidebar-link">Managing Users</a></li><li class="sidebar-sub-header"><a href="/cagefs/#command-line-tools" class="sidebar-link">Command-line Tools</a></li><li class="sidebar-sub-header"><a href="/cagefs/#running-command-inside-cagefs" class="sidebar-link">Running Command Inside CageFS</a></li><li class="sidebar-sub-header"><a href="/cagefs/#sanity-check" class="sidebar-link">Sanity Check</a></li><li class="sidebar-sub-header"><a href="/cagefs/#cagefs-quirks" class="sidebar-link">CageFS Quirks</a></li><li class="sidebar-sub-header"><a href="/cagefs/#configuration" class="sidebar-link">Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cagefs/#file-system-templates" class="sidebar-link">File System Templates</a></li><li class="sidebar-sub-header"><a href="/cagefs/#excluding-files" class="sidebar-link">Excluding Files</a></li><li class="sidebar-sub-header"><a href="/cagefs/#excluding-users" class="sidebar-link">Excluding Users</a></li><li class="sidebar-sub-header"><a href="/cagefs/#mount-points" class="sidebar-link">Mount Points</a></li><li class="sidebar-sub-header"><a href="/cagefs/#base-home-directory" class="sidebar-link">Base Home Directory</a></li><li class="sidebar-sub-header"><a href="/cagefs/#postgresql-support" class="sidebar-link">PostgreSQL support</a></li><li class="sidebar-sub-header"><a href="/cagefs/#pam-configuration" class="sidebar-link">PAM Configuration</a></li><li class="sidebar-sub-header"><a href="/cagefs/#executing-by-proxy" class="sidebar-link">Executing By Proxy</a></li><li class="sidebar-sub-header"><a href="/cagefs/#custom-etc-files-per-customer" class="sidebar-link">Custom /etc files per customer</a></li><li class="sidebar-sub-header"><a href="/cagefs/#moving-cagefs-skeleton-directory" class="sidebar-link">Moving cagefs-skeleton directory</a></li><li class="sidebar-sub-header"><a href="/cagefs/#moving-var-cagefs-directory" class="sidebar-link">Moving /var/cagefs directory</a></li><li class="sidebar-sub-header"><a href="/cagefs/#tmp-directories" class="sidebar-link">TMP Directories</a></li><li class="sidebar-sub-header"><a href="/cagefs/#syslog" class="sidebar-link">Syslog</a></li><li class="sidebar-sub-header"><a href="/cagefs/#excluding-mount-points" class="sidebar-link">Excluding mount points</a></li></ul></li><li class="sidebar-sub-header"><a href="/cagefs/#control-panel-integration" class="sidebar-link">Control Panel Integration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cagefs/#cpanel" class="sidebar-link">cPanel</a></li><li class="sidebar-sub-header"><a href="/cagefs/#plesk" class="sidebar-link">Plesk</a></li><li class="sidebar-sub-header"><a href="/cagefs/#ispmanager" class="sidebar-link">ISPManager</a></li></ul></li></ul></li><li><a href="/mysql_governor/" class="sidebar-link">MySQL Governor</a></li><li><a href="/php_selector/" class="sidebar-link">PHP Selector</a></li><li><a href="/python_and_ruby_selector/" class="sidebar-link">Python</a></li><li><a href="/node_js_selector/" class="sidebar-link">Node.js Selector</a></li><li><a href="/inodes_limits/" class="sidebar-link">inodes</a></li><li><a href="/kernel_settings/" class="sidebar-link">Kernel Settings</a></li><li><a href="/apache_mod_lsapi/" class="sidebar-link">Apache mod_lsapi</a></li><li><a href="/cloudlinux-fchange/" class="sidebar-link">File Change API</a></li><li><a href="/mod_proctitle/" class="sidebar-link">mod_proctitle</a></li><li><a href="/additional_packages/" class="sidebar-link">Additional Packages</a></li><li><a href="/integration_guide/" class="sidebar-link">Integration Guide</a></li><li><a href="/partner_portal/" class="sidebar-link">Partner Portal</a></li><li><a href="/cloudlinux_network/" class="sidebar-link">CloudLinux Network</a></li><li><a href="/cloudlinux_whmcs_plugin/" class="sidebar-link">CloudLinux WHMCS Plugin</a></li><li><a href="/deprecated/" class="sidebar-link">Deprecated</a></li><li><a href="/hardware_compatibility/" class="sidebar-link">Hardware Compatibility</a></li><li><a href="/cloudlinux_life-cycle/" class="sidebar-link">CloudLinux Life cycle</a></li><li><a href="/downloading_documentation/" class="sidebar-link">Downloading Documentation</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="cagefs"><a href="#cagefs" aria-hidden="true" class="header-anchor">#</a> CageFS</h1> <p>CageFS is a virtualized file system and a set of tools to contain each user in its own 'cage'. Each customer will have its own fully functional CageFS, with all the system files, tools, etc.</p> <p>The benefits of CageFS are:</p> <p>·        Only safe binaries are available to user
·        User will not see any other users, and would have no way to detect presence of other users &amp; their user names on the server
·        User will not be able to see server configuration files, such as Apache config files.
·        User's will have limited view of /proc file system, and will not be able to see other' users processes</p> <p>At the same time, user's environment will be fully functional, and user should not feel in any way restricted. No adjustments to user's scripts are needed. CageFS will cage any scripts execution done via:</p> <p>·        Apache (suexec, suPHP, mod_fcgid, mod_fastcgi)
·        LiteSpeed Web Server
·        Cron Jobs
·        SSH
·        Any other enabled service</p> <h2 id="installation"><a href="#installation" aria-hidden="true" class="header-anchor">#</a> Installation</h2> <p>Minimum Requirements:</p> <p>·        kernel: CL5 with lve0.8.54 or later, CL6 with lve1.2.17.1 or later, CL7.
·        7GB of disk space.</p> <p>Depending on your setup, and number of users, you might also need:
Up to 8MB per customer in /var directory (to store custom /etc directory)
5GB to 20GB in /usr/share directory (to store safe skeleton of a filesystem)</p> <p>To install CageFS:</p> <div class="language- extra-class"><pre class="language-text"><code>$ yum install cagefs
$ /usr/sbin/cagefsctl --init
</code></pre></div><p>That last command will create skeleton directory that might be around 7GB in size. If you don't have enough disk space in /usr/share, use following commands to have cagefs-skeleton being placed in a different location:</p> <div class="language- extra-class"><pre class="language-text"><code>$ mkdir /home/cagefs-skeleton
$ ln -s /home/cagefs-skeleton /usr/share/cagefs-skeleton
</code></pre></div><p>On cPanel servers, if you will be placing skeleton into /home directory, you must configure the following option in:
cPanel WHM -&gt; Server Configuration -&gt; Basic cPanel/WHM Setup -&gt; Basic Config -&gt; Additional home directories
Change the value to blank  (not default &quot;home&quot;)
Without changing this option, cPanel will create new accounts in incorrect places.</p> <p>CageFS will automatically detect and configure all necessary files for:
·        cPanel
·        Plesk
·        DirectAdmin
·        ISPmanager
·        Interworx
·        MySQL
·        PostgreSQL
·        LiteSpeed</p> <p>Web interface to manage CageFS is available for cPanel, Plesk 10+, DirectAdmin, ISPmanager &amp; Interworx. Command line tool would need to be used for other control panels.</p> <p>Once you initialized the template you can start enabling users. By default CageFS is disabled for all users.</p> <p>When installing/upgrading, the fs.proc_can_see_other_uid parameter is set to 0 if it is available in /etc/sysctl.conf, but then it will be written to /etc/sysctl.d/90-cloudlinux.conf.
We recommend set fs.proc_can_see_other_uid=0 to activate protection with hidepid option.</p> <h2 id="unistalling-cagefs"><a href="#unistalling-cagefs" aria-hidden="true" class="header-anchor">#</a> Unistalling CageFS</h2> <p>To uninstall CageFS, start by disabling and removing all directories:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --remove-all
</code></pre></div><p>That command will: Disable CageFS for all customers, unmount CageFS for all users, removes directories. It will not remove /etc/cagefs directory.</p> <p>Remove CageFS RPM:</p> <div class="language- extra-class"><pre class="language-text"><code>$ yum remove cagefs
</code></pre></div><h2 id="managing-users"><a href="#managing-users" aria-hidden="true" class="header-anchor">#</a> Managing Users</h2> <p>CageFS provides for two modes of operations:</p> <ol><li><pre><code>   Enabled for all, except those that are disabled.
</code></pre></li> <li><pre><code>   Disabled for all, except those that are enabled.
</code></pre></li></ol> <p>Mode #1 is convenient for production operation, where you want all new users to automatically be added to CageFS.
Mode #2 is convenient while you test CageFS, as it allows you to enable it on one by one for your customers.</p> <p>To start using CageFS you have to select one of the mode of operations:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --enable-all
</code></pre></div><p>or</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --disable-all
</code></pre></div><p>or</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --toggle-mode
</code></pre></div><p>That will switch the operation mode, preserving current disabled/enabled users.</p> <p>To enable individual user do:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --enable [username]
</code></pre></div><p>To disable individual user:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --disable [username]
</code></pre></div><p>To  list all enabled users:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --list-enabled
</code></pre></div><p>To list all disabled users:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --list-disabled
</code></pre></div><p>To see current mode of operation:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --display-user-mode
</code></pre></div><h2 id="command-line-tools"><a href="#command-line-tools" aria-hidden="true" class="header-anchor">#</a> Command-line Tools</h2> <p>_cagefsctl _ is used to manage CageFS. It allows initializing and updating CageFS, as well as enabling/disabling CageFS for individual users.</p> <p>Use the following syntax to manage CageFS:</p> <p>Use the following syntax to manage users:</p> <p>Common options:</p> <h2 id="running-command-inside-cagefs"><a href="#running-command-inside-cagefs" aria-hidden="true" class="header-anchor">#</a> Running Command Inside CageFS</h2> <p>Sometimes you will need to execute a command as user inside CageFS.</p> <p>If a user has shell enabled - you can simply use:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /bin/su - $USERNAME  -c &quot;_command_&quot;
</code></pre></div><p>Yet, if user has shell disabled, it wouldn't work. To solve this issue, we have added command:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /sbin/cagefs_enter_user $USERNAME &quot;_command_&quot;
</code></pre></div><p>If you disable CageFS for a user,  then will be executed without .</p> <p>You can forcibly disable start via for all users (regardless if CageFS is enabled or disabled) by specifying the parameter <em>cagefs_enter_proxied=0</em> in <em>/etc/sysconfig/cloudlinux</em> .</p> <p><em>/bin/cagefs_enter.proxied</em> can be executed instead of <em>/bin/cagefs_enter</em> to enter CageFS without . Note that starting via is necessary to enable sending local notification messages to users with enabled CageFS. is executed via by default.</p> <h2 id="sanity-check"><a href="#sanity-check" aria-hidden="true" class="header-anchor">#</a> Sanity Check</h2> <p>CageFS utility allows to check CageFS configuration consistency, so that an administrator can save the time investigating issues with CageFS and ensure that custom configuration is correct.</p> <p>To start run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>cagefsctl --sanity-check
</code></pre></div><p>At the moment 7 types of check are implemented:</p> <p><em>Check cagefs mount points exists</em> - reads file and verifies if the directories specified in it really exist on the disk. To learn more visit <a href="https://docs.cloudlinux.com/index.html?mount_points.html" target="_blank" rel="noopener noreferrer">https://docs.cloudlinux.com/index.html?mount_points.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and <a href="https://docs.cloudlinux.com/index.html?split_by_username.html" target="_blank" rel="noopener noreferrer">https://docs.cloudlinux.com/index.html?split_by_username.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><em>Check cagefs users.enabled is directory</em> - ensures that if exists, then it is a directory, not a file (if it is recognized as a file, then it would cause a breakdown).</p> <p><em>Check cagefs users.disabled is directory</em> - ensures that if exists, then it is a directory, not a file (if it is recognized as a file, then it would cause a breakdown).</p> <p><em>Check cagefs disable.etcfs exists</em> - checks if exists.</p> <p><em>Check cagefs users can enter cagefs</em> - chooses two users in the system with enabled CageFS (the first and the second ones in the unsorted list) and tries to log in to CageFS under their credentials and see what happens. It runs and compares the output with the and command retcode estimation.</p> <p><strong>Note.</strong> <em>If log in fails, it can be on different reasons, that can only be determined in manual mode. The checker only gives the output of the command.</em></p> <p><em>Check cagefs proxy commands configs are parsable</em> - tries to load files and parse them to check the syntax. In case of any parsing error the test will fail. To learn more visit <a href="https://docs.cloudlinux.com/index.html?executing_by_proxy.html" target="_blank" rel="noopener noreferrer">https://docs.cloudlinux.com/index.html?executing_by_proxy.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .</p> <p><em>Check cagefs virt.mp files syntax</em> - reads all files (if any) and checks their syntax validity. At the moment there are only two checks of the syntax: the file is not empty if it exists, and the file is not starting with the sub directory definitions (with @). To learn more visit <a href="https://docs.cloudlinux.com/index.html?per_user_virtual_mount_points.html" target="_blank" rel="noopener noreferrer">https://docs.cloudlinux.com/index.html?per_user_virtual_mount_points.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Possible results of the checks:</p> <ul><li><p>the check succeeded.</p></li> <li><p>the check revealed a problem.</p></li> <li><p>the check was skipped as it made no sense in such environment (e.g. wrong control panel) or can not be performed for some reason (e.g no users with enabled CageFS found). The actual result does not mean that a problem exists and can be considered as positive.</p></li> <li><p>the check failed because of a problem inside the checker itself. Must be reported to the developers.</p></li></ul> <p>In case if at least one of the checks resulted neither nor then the checker will end with ret code &gt;0.</p> <h2 id="cagefs-quirks"><a href="#cagefs-quirks" aria-hidden="true" class="header-anchor">#</a> CageFS Quirks</h2> <p>Due to the nature of CageFS, some options will not work as before or will require some changes:</p> <p>lastlog will not work ( <em>/var/log/lastlog</em> ).
PHP will load php.ini from <em>/usr/selector/php.ini.</em> That file is actually a link to a real php.ini file from your system. So the same php.ini will be loaded in the end.
You have to run <code>cagefsctl --update</code> any time you have modified php.ini, or you want to get new/updated software inside CageFS.
CageFS installation changes jailshell to regular bash on cPanel - <a href="http://kb.cloudlinux.com/2015/11/why-cagefs-installation-change-jailshell-to-regular-bash-on-cpanel/" target="_blank" rel="noopener noreferrer">read why<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> .</p> <h2 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h2> <p><a href="/file_system_templates/">File System Templates</a></p> <p><a href="/excluding_files/">Excluding Files</a></p> <p><a href="/excluding_users/">Excluding Users</a></p> <p><a href="/mount_points/">Mount Points</a></p> <p><code>o</code> <a href="/per_user_virtual_mount_points/">Per user virtual mount points</a></p> <p><code>o</code> <a href="/split_by_username/">Split by Username</a></p> <p><a href="/base_home_directory/">Base Home Directory</a></p> <p><a href="/postgresql_support/">PostgreSQL support</a></p> <p><a href="/pam_configuration/">PAM Configuration</a></p> <p><a href="/executing_by_proxy/">Executing By Proxy</a></p> <p><a href="/custom__etc_directory/">Custom /etc directory</a></p> <p><a href="/moving_cagefs-skeleton_directory/">Moving cagefs-skeleton directory</a></p> <p><a href="/moving__var_cagefs_directory/">Moving /var/cagefs directory</a></p> <p><a href="/tmp_directories/">TMP directories</a></p> <p><a href="/syslog/">Syslog</a></p> <p><a href="/excluding_mount_points/">Excluding mount points</a></p> <h3 id="file-system-templates"><a href="#file-system-templates" aria-hidden="true" class="header-anchor">#</a> File System Templates</h3> <p>CageFS creates a filesystem template in directory. CageFS template will be mounted for each customer.  The template is created by running:</p> <div class="language- extra-class"><pre class="language-text"><code># /usr/sbin/cagefsctl --init
</code></pre></div><p>To update the template, you should run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --update
</code></pre></div><p>The behavior of the commands (and the files copied into directory) depends on the configuration files in /etc/cagefs/conf.d
You can add additional files, users, groups and devices into CageFS template by adding .cfg file, and running:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --update
</code></pre></div><p>To delete files from CageFS template, remove corresponding .cfg file, and run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ /usr/sbin/cagefsctl --update
</code></pre></div><p>Here is an example file:</p> <div class="language- extra-class"><pre class="language-text"><code>[openssh-clients]
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>comment=OpenSSH Clients
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>paths=/etc/ssh/ssh_config, /bin/hostname, /usr/bin/scp, /usr/bin/sftp, /usr/bin/slogin, /usr/bin/ssh, /usr/bin/ssh-add, /usr/bin/ssh-agent, /usr/bin/ssh-copy-id, /usr/bin/.ssh.hmac, /usr/bin/ssh-keyscan, /usr/libexec/openssh/sftp-server, /etc/environment, /etc/security/pam_env.conf
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>devices=/dev/ptmx
</code></pre></div><p>Example file:</p> <div class="language- extra-class"><pre class="language-text"><code>[mail]
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>comment=Mail tools
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>paths=/bin/mail, /etc/aliases.db, /etc/mail, /etc/mailcap, /etc/mail.rc, /etc/mime.types, /etc/pam.d/smtp.sendmail, /etc/rc.d/init.d/sendmail, /etc/smrsh, /etc/sysconfig/sendmail, /usr/bin/hoststat, /usr/bin/Mail, /usr/bin/mailq.sendmail, /usr/bin/makemap, /usr/bin/newaliases.sendmail, /usr/bin/purgestat, /usr/bin/rmail.sendmail, /usr/lib64/sasl2/Sendmail.conf, /usr/lib/mail.help, /usr/lib/mail.tildehelp, /usr/lib/sendmail.sendmail, /usr/sbin/mailstats, /usr/sbin/makemap, /usr/sbin/praliases, /usr/sbin/sendmail.sendmail, /usr/sbin/smrsh, /var/log/mail, /var/spool/clientmqueue, /var/spool/mqueue
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>users=smmsp
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>groups=smmsp
</code></pre></div><p>There is an easy way to add/delete files from particular s into CageFS. That can be done by using options in . Like:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --addrpm ffmpeg
$ cagefsctl --update
</code></pre></div><h3 id="excluding-files"><a href="#excluding-files" aria-hidden="true" class="header-anchor">#</a> Excluding Files</h3> <p>To exclude files and directories from CageFS, edit file:</p> <p>And add files or directories in there, one per line.</p> <p>Please do not edit /etc/cagefs/black.list file because it is replaced during the update of CageFS package.</p> <h3 id="excluding-users"><a href="#excluding-users" aria-hidden="true" class="header-anchor">#</a> Excluding Users</h3> <p>To exclude users from CageFS, create a file (any name would work) inside _ _ <code></code> folder, and list users that you would like to exclude from CageFS in that file.</p> <h3 id="mount-points"><a href="#mount-points" aria-hidden="true" class="header-anchor">#</a> Mount Points</h3> <p>CageFS creates individual namespace for each user, making it impossible for users to see each other's files and creating high level of isolation. The way namespace is organized:</p> <ol><li>with safe files is created</li> <li><pre><code>   Any directory from the server that needs to be shared across all users is mounted into
</code></pre></li></ol> <p>a.        list of such directories is defined in /etc/cagefs/cagefs.mp
3. directory for each user. Prefix is defined as last two digits of user id. User id is taken from /etc/passwd file.
4.        Separate /etc directory is created and populated for each user inside
5.        /tmp directory is mounted for each user separately into
6.        Additional custom directories can be mounted for each user by defining them in /etc/cagefs/cagefs.mp
7. You can define custom directories per user using <a href="/per_user_virtual_mount_points/">virt.mp</a> files [CageFS 5.1 and higher]</p> <p>To define individual custom directories in /etc/cagefs/cagefs.mp following format is used:</p> <p>This is useful when you need to give each user its own copy of a particular system directory, like:</p> <p>Such entry would create separate for each user, with permissions set to 777</p> <p>To modify mount points, edit /etc/cagefs/cagefs.mp. Here is an example of cagefs.mp:</p> <div class="language- extra-class"><pre class="language-text"><code>/var/lib/mysql
/var/lib/dav
/var/www/cgi-bin
/var/spool
/dev/pts
/usr/local/apache/domlogs
/proc
/opt
@/var/spool/cron,700
@/var/run/screen,777
</code></pre></div><p>If you want to change mount points, make sure you re-initialize mount points for all customers:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --remount-all
</code></pre></div><p>This command will kill all current processes and reset mount points.</p> <h4 id="per-user-virtual-mount-points"><a href="#per-user-virtual-mount-points" aria-hidden="true" class="header-anchor">#</a> Per user virtual mount points</h4> <p><strong>[CageFS 5.1 and higher]</strong></p> <ul><li>_Please, see _</li></ul> <p>Starting with CageFS 5.1 you can specify additional directories to be mounted inside user's CageFS. This can be specified for each user.
To specify virtual mount points for a user, create a file:</p> <p>Inside that file, you can specify mount points in the following format:</p> <div class="language- extra-class"><pre class="language-text"><code>virtdir1,mask
@subdir1,mask
@subdir2,mask
virdir2,mask
@subdir3,mask
@subdir4,mask
&gt;virtdir3,mask
@subdir5,mask
@subdir6,mask
# comments
</code></pre></div><p>is always optional, if missing 0755 is used
Create virtual directory , mount it to:
<code>o</code> <code>o</code> inside virtual directory, create directories
<code>o</code> mount to
<code>o</code> if is started with &gt;, create directory , but don't mount it into . This is needed for cases when is inside home base dir.
if file /var/cagefs/[prefix]/[user]/virt.mp is missing -- no virt directories are loaded for that user.</p> <p>Note that CageFS will automatically create those files for Plesk 10 &amp; higher.</p> <p>For example if we have plesk11.5 with two users , and :</p> <div class="language- extra-class"><pre class="language-text"><code>cltest1 uid 10000 has domains: cltest1.com, cltest1-addon.com and sub1.cltest1.com
cltest2 uid 10001 has domains: cltest2.com, cltest2-addon.com
</code></pre></div><p>In such case we would have file <em>/var/cagefs/00/cltest1/virt.mp</em> :</p> <div class="language- extra-class"><pre class="language-text"><code>&gt;/var/www/vhosts/system,0755
@cltest1-addon.com,0755
@cltest1.com,0755

</code></pre></div><p>and file: _ /var/cagefs/01/cltest2/virt.mp:_</p> <div class="language- extra-class"><pre class="language-text"><code>&gt;/var/www/vhosts/system
@cltest2-addon.com

</code></pre></div><h4 id="split-by-username"><a href="#split-by-username" aria-hidden="true" class="header-anchor">#</a> Split by Username</h4> <p><strong>[CageFS 5.3.1+]</strong></p> <p>Sometimes you might need to make sure that directory containing all users would show up as containing just that user inside CageFS. For example, if you have directory structure like:</p> <div class="language- extra-class"><pre class="language-text"><code>/home/httpd/fcgi-bin/user1
/home/httpd/fcgi-bin/user2
</code></pre></div><p>Then we can add the following line to /etc/cagefs/cagefs.mp file:</p> <div class="language- extra-class"><pre class="language-text"><code>%/home/httpd/fcgi-bin
</code></pre></div><p>and execute:</p> <div class="language- extra-class"><pre class="language-text"><code>cagefsctl --remount-all
</code></pre></div><p>After that each subdirectory of /home/httpd/fcgi-bin will be mounted for appropriate user in CageFS: will be mounted for and will be mounted for .</p> <h4 id="mounting-user’s-home-directory-inside-cagefs"><a href="#mounting-user’s-home-directory-inside-cagefs" aria-hidden="true" class="header-anchor">#</a> Mounting user’s home directory inside CageFS</h4> <p>CageFS 6.1-1 (and later) has improved mounting user’s home directory that is applied for users with home directories like (where = 0,1,..9).</p> <p>In such case, earlier versions of CageFS always mount user’s home directory to and create symlink when needed, so user’s home directory can be accessed both via _ _ and . This quirk leads to some rare incompatibilities between CageFS and other software (for example OpenCart), because real path of user’s home directory in CageFS and in real file system can differ.</p> <p>New CageFS mounts user’s home directory in a way that its real path in CageFS is always the same as in real file system. Additionally, CageFS searches for symlinks like
and _ _ in real system and creates such symlinks in user’s CageFS when found.</p> <p>This new mounting mode is enabled by default. You can switch to old mounting mode by executing the following commands:</p> <div class="language- extra-class"><pre class="language-text"><code># touch /etc/cagefs/disable.home.dirs.search
# cagefsctl --force-update
# cagefsctl --remount-all
</code></pre></div><h3 id="base-home-directory"><a href="#base-home-directory" aria-hidden="true" class="header-anchor">#</a> Base Home Directory</h3> <p>If you have a custom setup where home directories are in a special format, like: , you can specify it using regular expressions. This is needed by CageFS to create safe home space for end user, where no other users are visible.</p> <p>We will create empty: , and then mount in that directory</p> <p>To do that, create a file:</p> <p>With content like:</p> <div class="language- extra-class"><pre class="language-text"><code>^/home/
^/var/www/users/
</code></pre></div><p>If there is no such file, the home directory without last component will be considered as a base dir, like with
we would create , and then mount
in there</p> <p>WIth as a home dir, we would assume that is the base directory, and we would create and then we would mount -- which would cause each user to see empty base directories for other users, exposing user names.</p> <p>When you want to share directory structure among multiple users, you can add following line at the top of the file. This is useful on the systems that support sites with multiple users, with different home directories inside main 'site' directory.</p> <div class="language- extra-class"><pre class="language-text"><code>mount_basedir=1
</code></pre></div><p>For example:</p> <p>has home directory
has home directory
site admin has home directory</p> <p>So, content of should be the following:</p> <div class="language- extra-class"><pre class="language-text"><code>mount_basedir=1
^/var/www/vhosts/[^/]+
</code></pre></div><p>Directory structure in will be mounted in CageFS for appropriate users.
Each user will have access to whole directory structure in (according to their permissions).</p> <h3 id="postgresql-support"><a href="#postgresql-support" aria-hidden="true" class="header-anchor">#</a> PostgreSQL support</h3> <p>CloudLinux 7:</p> <p>CageFS works with any PostgreSQL version installed from CloudLinux or CentOS repositories. PostgreSQL packages fo CloudLinux 7 come from upstream (CentOS) unmodified. PostgreSQL’s socket is located in /var/run/postgresql directory. This directory is mounted to CageFS by default (in cagefs-5.5-6.34 or later).</p> <p>When PostgreSQL has been installed after CageFS install, please add line:</p> <div class="language- extra-class"><pre class="language-text"><code>/var/run/postgresql
</code></pre></div><p>tо /etc/cagefs/cagefs.mp file and then execute:</p> <div class="language- extra-class"><pre class="language-text"><code>cagefsctl --remount-all 
</code></pre></div><p>The steps above are enough to configure CageFS to work with PostgreSQL.</p> <p>CloudLinux 6:</p> <p>CageFS provides separate /tmp directory for each end user. Yet, PostgreSQL keeps its Unix domain socket inside server's main /tmp directory. In addition to that -- the location is hard coded inside PostgreSQL libraries.</p> <p>To resolve the issue, CloudLinux provides version of PostgreSQL with modified start up script that can store PostgreSQL's socket in /var/run/postgres. The script automatically creates link from /tmp to that socket to prevent PostgreSQL dependent applications from breaking.</p> <p>In addition to that, CageFS knows how to correctly link this socket inside end user's /tmp directory.</p> <p>To enable PostgreSQL support in CageFS:</p> <ol><li><pre><code>   Make sure you have updated to latest version of PostgreSQL.
</code></pre></li> <li><pre><code>   Edit file /etc/sysconfig/postgres, and uncomment line.
</code></pre></li> <li><p>Update CageFS configuration by running:</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>cagefsctl  --reconfigure-cagefs
</code></pre></div><ol start="4"><li>Restart PostgreSQL by running:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>$ service postgresql restart 
</code></pre></div><p>If you are using cPanel, you would also need to modify file: /etc/cron.daily/tmpwatch</p> <p>And update line:</p> <div class="language- extra-class"><pre class="language-text"><code>flags=-umc 
</code></pre></div><p>to:</p> <div class="language- extra-class"><pre class="language-text"><code>flags=-umcl
</code></pre></div><p>to prevent symlink from being removed.</p> <h3 id="pam-configuration"><a href="#pam-configuration" aria-hidden="true" class="header-anchor">#</a> PAM Configuration</h3> <p>CageFS depends on module tor PAM enabled services.When installed the module is automatically installed for following services:</p> <p>·        sshd
·        crond
·        su</p> <p>Following line is added to corresponding file in /etc/pam.d/:</p> <div class="language- extra-class"><pre class="language-text"><code>session    required     pam_lve.so      100     1
</code></pre></div><p>Where 100 stands for minimum to put into , and 1 stands for CageFS enabled.</p> <h3 id="executing-by-proxy"><a href="#executing-by-proxy" aria-hidden="true" class="header-anchor">#</a> Executing By Proxy</h3> <p>Some software has to run outside CageFS to be able to complete its job. This includes such programs as etc.</p> <p>CloudLInux uses technology to accomplish this goal. You can define any program to run outside CageFS, by specifying it in file. Do not edit existing as it will be overwritten with next CageFS update.</p> <p>Once program is defined, run this command to populate the skeleton:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --update
</code></pre></div><p>All the cPanel scripts located in that user might need to execute should be added to .</p> <p>The syntax of _ _ files is as follows:</p> <p><em>ALIAS:wrapper_name=username:path_to_executable</em></p> <p>Obligatory parameters are and _ _ .</p> <ul><li><p>any name which is unique within all files;</p></li> <li><p>the name of wrapper file, which is used as a replacement for executable file . Wrapper files are located in . If wrapper name is not specified, then default wrapper is used. Also, a reserved word can be used, it will intend that wrapper is not in use (installed before) - applied for the commands with several , as in the example below.</p></li></ul> <p>e - the name of a user on whose behalf will run in the real system. If is not specified, then will run on behalf the same user that is inside CageFS.</p> <ul><li>the path to executable file which will run via .</li></ul> <p>Example of a simple command executed via :</p> <div class="language- extra-class"><pre class="language-text"><code>SENDMAIL=/usr/sbin/sendmail
</code></pre></div><p>Example of command execution with custom wrapper under (privilege escalation). The command uses two , that is why in the second line is specified instead of wrapper name.</p> <div class="language- extra-class"><pre class="language-text"><code>CRONTAB_LIST:cagefs.proxy.crontab=root:/usr/bin/crontab
CRONTAB_SAVE:noproceed=root:/usr/bin/crontab
</code></pre></div><p>Sometimes hosters may have users with non unique . Thus, may traverse users directory to find a specific one. That behavior turns into inappropriate if users directory is not cached locally (for example LDAP is in use).</p> <p>To turn this feature off:</p> <div class="language- extra-class"><pre class="language-text"><code>touch /etc/cagefs/proxy.disable.duid
</code></pre></div><p>Or to activate it back:</p> <div class="language- extra-class"><pre class="language-text"><code>rm /etc/cagefs/proxy.disable.duid
</code></pre></div><h3 id="custom-etc-files-per-customer"><a href="#custom-etc-files-per-customer" aria-hidden="true" class="header-anchor">#</a> Custom /etc files per customer</h3> <p><strong>[4.0-5 and later]</strong></p> <p>To create custom file in /etc directory for end user, create a directory:</p> <p>Put all custom files, and sub-directories into that direcotry.</p> <p>For example, if you want to create custom /etc/hosts file for , create a directory:</p> <p>Inside that directory, create a file hosts, with the content for that user.</p> <p>After that execute:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --update-etc USER1
</code></pre></div><p>If you are making changes for multiple users, you can run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --update-etc
</code></pre></div><p>To remove custom file, remove it from directory, and re-run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --update-etc
</code></pre></div><h3 id="moving-cagefs-skeleton-directory"><a href="#moving-cagefs-skeleton-directory" aria-hidden="true" class="header-anchor">#</a> Moving cagefs-skeleton directory</h3> <p>Sometimes you might need to move from to another partition.</p> <p>There are two ways:</p> <ol><li>If is not created yet ( wasn't executed), then execute:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>$ mkdir /home/cagefs-skeleton 
$ ln -s /home/cagefs-skeleton /usr/share/cagefs-skeleton 
$ cagefsctl --init
</code></pre></div><ol start="2"><li>If already exists:</li></ol> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --disable-cagefs 
$ cagefsctl --unmount-all
# To ensure that the following command prints empty output: 
$ cat /proc/mounts | grep cagefs 
# if you see any cagefs entries, execute &quot;cagefsctl --unmount-all&quot; again.
$ mv /usr/share/cagefs-skeleton /home/cagefs-skeleton 
$ ln -s /home/cagefs-skeleton /usr/share/cagefs-skeleton
cagefsctl --enable-cagefs
</code></pre></div><p>On cPanel servers, if you place skeleton into directory, then you should configure the following option:</p> <p>In <em>cPanel WHM</em> choose and go to , then in change default _ _ value to (not ).</p> <h3 id="moving-var-cagefs-directory"><a href="#moving-var-cagefs-directory" aria-hidden="true" class="header-anchor">#</a> Moving /var/cagefs directory</h3> <p>To move /var/cagefs to another location:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --disable-cagefs
$ cagefsctl --unmount-all
</code></pre></div><p>Verify that directory does not exist (if it exists - change name &quot;cagefs.bak&quot; to something else)</p> <div class="language- extra-class"><pre class="language-text"><code>$ cp -rp /var/cagefs /new/path/cagefs
$ mv /var/cagefs /var/cagefs.bak
$ ln -s /new/path/cagefs /var/cagefs
$ cagefsctl --enable-cagefs
$ cagefsctl --remount-all
</code></pre></div><p>Verify that the following command gives empty output:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cat /proc/mounts | grep cagefs.bak
</code></pre></div><p>Then you can safely remove /var/cagefs.bak:</p> <div class="language- extra-class"><pre class="language-text"><code>$ rm -rf /var/cagefs.bak
</code></pre></div><h3 id="tmp-directories"><a href="#tmp-directories" aria-hidden="true" class="header-anchor">#</a> TMP Directories</h3> <p>CageFS makes sure that each user has his own directory, and that directory is the part of end-user's quota.</p> <p>The actual location of the directory is</p> <p>Once a day, using cron job, will clean up user's directory from all the files that haven't been accessed during 30 days.</p> <p>This can be changed by running:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --set-tmpwatch='/usr/sbin/tmpwatch -umclq 720'
</code></pre></div><p>Where 720 is the number of hours that the file had to be inaccessible to be removed.</p> <p>By default this is done at 03:37 AM, but you can also force the clean up outdated files that match 'chosen period' of all user's directories without waiting for a job to be launched by . Just run:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cagefsctl --tmpwatch
</code></pre></div><p>The following path will be cleaned as well:</p> <p>(actual location _ _ )</p> <p>You can configure <code></code> to clean custom directories inside .</p> <p>Create configuration file and specify directive as follows:</p> <p>After that directories and _ _ inside CageFS  will be cleaned automatically.</p> <p>Note that actual location of those directories in real file system is and .</p> <p><strong>Cleanup of PHP sessions</strong></p> <p>For cPanel servers, CageFS version 6.0-42 or higher performs cleaning of PHP sessions based on and directives specified in proper files.</p> <p>directive default value is 1440 seconds. Those session files will be deleted, that were created or had metadata (ctime) changes more time ago than it is specified in</p> <p>For versions value is normally .</p> <p>This applies to the following versions (or later):</p> <p>alt-php44-4.4.9-71;
alt-php51-5.1.6-81;
alt-php52-5.2.17-107;
alt-php53-5.3.29-59;
alt-php54-5.4.45-42;
alt-php55-5.5.38-24;
alt-php56-5.6.31-7;
alt-php70-7.0.23-5;
alt-php71-7.1.9-5;
alt-php72-7.2.0-0.rc.2.2.</p> <p>When using EasyApache 3, value is normally _ _ or . Seettings for EasyApache 3 are usualy taken from the file</p> <p>When using EasyApache 4, value is normally where corresponds to PHP version.</p> <p>Cleaning is started by cron , which starts the script twice within one hour.</p> <p>The settings for ea-php are located in or in , where corresponds to the PHP version.</p> <p>The settings for alt-php are located in _ _ files, where corresponds to PHP version.</p> <p>The cleaning script cleans php sessions for all PHP versions ( and ) regardless of whether a version is used or selected via or . When different values are specified for the same (for different php versions), the cleaning script will use the least value for cleaning . So, it is recommended to specify different for each PHP version.</p> <p>Users can define custom value of _ _ via PHP Selector in order to configure PHP's garbage collector, but that will not affect the script for cleaning PHP sessions. The script cleans PHP sessions based on global values of and directives taken from files mentioned above. Settings in custom users’ files are ignored.</p> <p><strong>Cleanup of PHP session files in Plesk</strong></p> <p>For Plesk servers, version 6.0-52 or higher is provided with a special cron job for removing obsolete PHP session files. Cleanup script runs once an hour (similar to how it is done in Plesk).</p> <p>Each time the script runs, it performs the cleanup of the paths:</p> <ol><li><p>set by directive in files. If is missing, then is used. Session files lifetime is set by directive. If it is not found, then 1440 seconds value is used (24 minutes, as in Plesk). Lifetime set in the file is only taken into consideration if it is longer than 1440 seconds, otherwise 1440 seconds is used. All the installed versions are processed.</p></li> <li><p>. Files lifetime is only defined by Plesk script . If the script is missing or returns errors, then this directory is not processed.</p></li></ol> <p>The following features are applied during the cleanup:</p> <p>all the users with higher than specified in are processed. Each user is processed independently from one another.</p> <p>only directories inside are being cleaned. The paths of the same name in the physical  file system are not processed.</p> <p>in all the detected directories, all the files with the names that correspond to mask are removed, the rest of the files are ignored.</p> <p>the files older than specified lifetime are removed.</p> <p>all non-fatal errors (lack of rights, missing directory) are ignored and do not affect the further work of the script.</p> <h3 id="syslog"><a href="#syslog" aria-hidden="true" class="header-anchor">#</a> Syslog</h3> <p>By default, should be available inside end user's . This is needed so that user's cronjobs and other things that user would get recorded in the system log files.</p> <p>This is controlled using file with the following content:</p> <div class="language- extra-class"><pre class="language-text"><code>$AddUnixListenSocket /usr/share/cagefs-skeleton/dev/log
</code></pre></div><p>To remove presence of inside CageFS, remove that file, and restart rsyslog service.</p> <h3 id="excluding-mount-points"><a href="#excluding-mount-points" aria-hidden="true" class="header-anchor">#</a> Excluding mount points</h3> <p>By default, all mounts from the real file system is inherited by namespaces of all . So, destroying all may be required in order to unmount some mount in real file system completely. Otherwise, mount point remains busy after unmounting it in the real file system because this mount exists in namespaces of .</p> <p>command saves all mounts from real file system as “default namespace” for later use in all . service executes command during startup.</p> <p>In (and later) there is an ability to exclude specific mounts from namespaces for all .
In order to do so, please create a file with list of mounts to exclude (one mount per line) as regular expressions, and then execute :</p> <div class="language- extra-class"><pre class="language-text"><code># cat /etc/container/exclude_mounts.conf    
^/dir1/
^/dir2$
# lvectl start
</code></pre></div><p>After that, all new created will be without mount and without mounts that start with (like , etc). To apply changes to existing you should recreate :</p> <div class="language- extra-class"><pre class="language-text"><code># lvectl destroy all   
# lvectl apply all
</code></pre></div><h2 id="control-panel-integration"><a href="#control-panel-integration" aria-hidden="true" class="header-anchor">#</a> Control Panel Integration</h2> <p>CageFS comes with a plugin for various control panels.</p> <p>The plugin allows to:</p> <p>·        Initialize CageFS;</p> <p>·        Select <a href="/managing_users/">mode of operation</a> ;</p> <p>·        See and modify the list of enabled/disabled users;</p> <p>·        Update CageFS skeleton.</p> <h3 id="cpanel"><a href="#cpanel" aria-hidden="true" class="header-anchor">#</a> cPanel</h3> <p>CageFS plugin for cPanel is located in section of WHM.</p> <p>It allows to initialize CageFS, select users CageFS will be enabled for, as well as update CageFS skeleton.</p> <p><img src="/images/_img1_zoom73.png" alt></p> <p>To enable CageFS for a proper user (users), in choose a user from the list on the right ( users) and click . The user will move to the list on the left ( users).</p> <p>To disable a user (users), choose a user from the list on the left ( users) and click . The user will move to the list on the right ( users).</p> <p>To update CageFS Skeleton click .</p> <p><img src="/images/_img2_zoom71.png" alt></p> <h3 id="plesk"><a href="#plesk" aria-hidden="true" class="header-anchor">#</a> Plesk</h3> <p>CageFS comes with a plugin for Plesk 10.x. It allows initializing and updating CageFS template, as well as managing users and mode of operation for CageFS.</p> <p>In modules section choose CageFS:</p> <p><img src="/images/plesk_cagefs_icon.png" alt>
To enable CageFS for a proper user (users), in choose a user from the list on the right ( users) and click . The user will move to the list on the left ( users).</p> <p>To disable a user (users), choose a user from the list on the left ( users) and click . The user will move to the list on the right ( users).</p> <p>To update click .</p> <p><img src="/images/plesk_cagefs_manager_disable_all.png" alt></p> <h3 id="ispmanager"><a href="#ispmanager" aria-hidden="true" class="header-anchor">#</a> ISPManager</h3> <p>CageFS comes with plugin for to enable/disable CageFS on per user base. In edit user section chose tab. Mark checkbox and click to apply.</p> <p><img src="/images/ispmanager_cagefs_user_zoom98.png" alt></p> <p>Or you can manage global CageFS settings via CageFS menu
<img src="/images/_img3.jpg" alt></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/lve-stats_2/" class="prev">
          LVE-Stats 2
        </a></span> <span class="next"><a href="/mysql_governor/">
          MySQL Governor
        </a>
        →
      </span></p></div> </div> <div class="footer" data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.com" data-v-ac83a848><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-ac83a848></a></div> <div data-v-ac83a848>2018. CloudLinux Inc</div> <div data-v-ac83a848><div data-v-ac83a848><a href="#" target="_blank" data-v-ac83a848>How to</a></div><div data-v-ac83a848><a href="#" target="_blank" data-v-ac83a848>Getting started</a></div><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-ac83a848>Contact support</a></div><div data-v-ac83a848><a href="https://www.cloudlinux.com/blog" target="_blank" data-v-ac83a848>Blog</a></div></div> <div class="social" data-v-ac83a848><span data-v-ac83a848>Stay in touch</span> <a href="https://www.facebook.com/cloudlinux/" target="_blank" data-v-ac83a848><img src="/fb.svg" data-v-ac83a848></a><a href="https://twitter.com/cloudlinuxos/" target="_blank" data-v-ac83a848><img src="/tw.svg" data-v-ac83a848></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-ac83a848><img src="/in.svg" data-v-ac83a848></a><a href="https://www.youtube.com/channel/UCZ3YMHWnMP7TaxlXVay5-aw" target="_blank" data-v-ac83a848><img src="/ytube.svg" data-v-ac83a848></a></div></div> <!----></div></div>
    <script src="/assets/js/app.0abf6f2a.js" defer></script><script src="/assets/js/6.3f73b2ab.js" defer></script>
  </body>
</html>
