<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kernel Settings | Documentation</title>
    <meta name="description" content="Kernelcare documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.166b4f65.css" as="style"><link rel="preload" href="/assets/js/app.0abf6f2a.js" as="script"><link rel="preload" href="/assets/js/17.1fdd51cc.js" as="script"><link rel="prefetch" href="/assets/js/10.637ec29d.js"><link rel="prefetch" href="/assets/js/11.5bc4e224.js"><link rel="prefetch" href="/assets/js/12.86ab74a0.js"><link rel="prefetch" href="/assets/js/13.57ab5c71.js"><link rel="prefetch" href="/assets/js/14.fd3e69ee.js"><link rel="prefetch" href="/assets/js/15.ae08bd81.js"><link rel="prefetch" href="/assets/js/16.c78fdb9f.js"><link rel="prefetch" href="/assets/js/18.2e9e3c46.js"><link rel="prefetch" href="/assets/js/19.6a071eb7.js"><link rel="prefetch" href="/assets/js/20.03d7f633.js"><link rel="prefetch" href="/assets/js/21.c64caaaa.js"><link rel="prefetch" href="/assets/js/22.c03a1b94.js"><link rel="prefetch" href="/assets/js/23.a5cd9404.js"><link rel="prefetch" href="/assets/js/24.b90fb854.js"><link rel="prefetch" href="/assets/js/25.42c7c91b.js"><link rel="prefetch" href="/assets/js/26.159622d1.js"><link rel="prefetch" href="/assets/js/27.e8de38ef.js"><link rel="prefetch" href="/assets/js/28.ac2756db.js"><link rel="prefetch" href="/assets/js/3.5515951d.js"><link rel="prefetch" href="/assets/js/4.4d6450cb.js"><link rel="prefetch" href="/assets/js/5.90579adc.js"><link rel="prefetch" href="/assets/js/6.3f73b2ab.js"><link rel="prefetch" href="/assets/js/7.a073d98e.js"><link rel="prefetch" href="/assets/js/8.29039cd1.js"><link rel="prefetch" href="/assets/js/9.ef4b91a3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.28e1d2e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.166b4f65.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.com/trial" target="_blank" class="btn">
      Try Free
    </a> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Content</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/cloudlinux_installation/" class="sidebar-link">Installation</a></li><li><a href="/limits/" class="sidebar-link">Limits</a></li><li><a href="/lve_manager/" class="sidebar-link">LVE Manager</a></li><li><a href="/reseller_limits/" class="sidebar-link">Reseller Limits</a></li><li><a href="/lve-stats_2/" class="sidebar-link">LVE-Stats 2</a></li><li><a href="/cagefs/" class="sidebar-link">CageFS</a></li><li><a href="/mysql_governor/" class="sidebar-link">MySQL Governor</a></li><li><a href="/php_selector/" class="sidebar-link">PHP Selector</a></li><li><a href="/python_and_ruby_selector/" class="sidebar-link">Python</a></li><li><a href="/node_js_selector/" class="sidebar-link">Node.js Selector</a></li><li><a href="/inodes_limits/" class="sidebar-link">inodes</a></li><li><a href="/kernel_settings/" class="active sidebar-link">Kernel Settings</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kernel_settings/#kernel-config-variables" class="sidebar-link">Kernel Config Variables</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#virtualized-proc-filesystem" class="sidebar-link">Virtualized /proc filesystem</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#securelinks" class="sidebar-link">SecureLinks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kernel_settings/#symlink-owner-match-protection" class="sidebar-link">Symlink Owner Match Protection</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#link-traversal-protection" class="sidebar-link">Link Traversal Protection</a></li></ul></li><li class="sidebar-sub-header"><a href="/kernel_settings/#ptrace-block" class="sidebar-link">ptrace Block</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#xen-xvda" class="sidebar-link">Xen XVDA</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#tpe-extension-deprecated" class="sidebar-link">TPE Extension (deprecated)</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#io" class="sidebar-link">IO</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#hybrid-kernel" class="sidebar-link">Hybrid Kernel</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#reading" class="sidebar-link">Reading</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#flashcache" class="sidebar-link">flashcache</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#oom-killer" class="sidebar-link">OOM Killer</a></li><li class="sidebar-sub-header"><a href="/kernel_settings/#file-system-quotas" class="sidebar-link">File System Quotas</a></li></ul></li><li><a href="/apache_mod_lsapi/" class="sidebar-link">Apache mod_lsapi</a></li><li><a href="/cloudlinux-fchange/" class="sidebar-link">File Change API</a></li><li><a href="/mod_proctitle/" class="sidebar-link">mod_proctitle</a></li><li><a href="/additional_packages/" class="sidebar-link">Additional Packages</a></li><li><a href="/integration_guide/" class="sidebar-link">Integration Guide</a></li><li><a href="/partner_portal/" class="sidebar-link">Partner Portal</a></li><li><a href="/cloudlinux_network/" class="sidebar-link">CloudLinux Network</a></li><li><a href="/cloudlinux_whmcs_plugin/" class="sidebar-link">CloudLinux WHMCS Plugin</a></li><li><a href="/deprecated/" class="sidebar-link">Deprecated</a></li><li><a href="/hardware_compatibility/" class="sidebar-link">Hardware Compatibility</a></li><li><a href="/cloudlinux_life-cycle/" class="sidebar-link">CloudLinux Life cycle</a></li><li><a href="/downloading_documentation/" class="sidebar-link">Downloading Documentation</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="kernel-settings"><a href="#kernel-settings" aria-hidden="true" class="header-anchor">#</a> Kernel Settings</h1> <p><a href="/kernel_config_variables/">Kernel Config Variables</a> <a href="/virtualized_proc_filesystem/">Virtualized /proc filesystem</a></p> <p><a href="/securelinks/">SecureLinks</a></p> <p><code>o</code> <a href="/symlink_owner_match_protection/">Symlink Owner Match Protection</a></p> <p><code>o</code> <a href="/link_traversal_protection/">Link Traversal Protection</a></p> <p><a href="/ptrace_block/">ptrace Block</a></p> <p><a href="/xen_xvda_detection/">Xen XVDA detection</a></p> <p><a href="/tpe_extension/">TPE Extension</a></p> <p><a href="/iolimits_latency/">IO Limits latency</a></p> <p><a href="/hybrid_kernel/">Hybrid Kernel</a></p> <p><a href="/reading_lve_usage/">Reading LVE usage</a></p> <p><a href="/flashcache/">flashcache</a></p> <p><a href="/oom_killer_for_lve_processes/">OOM Killer for LVE Processes</a></p> <p><a href="/file_system_quotas/">File System Quotas</a></p> <h2 id="kernel-config-variables"><a href="#kernel-config-variables" aria-hidden="true" class="header-anchor">#</a> Kernel Config Variables</h2> <p>Starting from <strong>lvemanager 4.0-25.5</strong> , <strong>lve-utils 3.0-21.2</strong> , and <strong>cagefs-6.1-26</strong> , CloudLinux OS utilities can read/write kernel config variables from a custom config _/etc/sysctl.d/90-cloudlinux.conf _ (earlier, the parameters were read/written only from <em>sysctl.conf</em> ).</p> <p>CloudLinux OS utilities get parameter by using <em>sysctl</em> system utility. So for now, even if a config variable is not set in the <em>sysctl.conf</em> and in the <em>/etc/sysctl.d</em> config files, this variable will be read by <em>sysctl</em> utility directly from <em>/proc/sys</em> .</p> <p>If some kernel variable was set in <em>/etc/sysctl.d/90-cloudlinux.conf</em> do</p> <div class="language- extra-class"><pre class="language-text"><code>sysctl --system
</code></pre></div><p>to apply the parameters before reading and after writing.</p> <h2 id="virtualized-proc-filesystem"><a href="#virtualized-proc-filesystem" aria-hidden="true" class="header-anchor">#</a> Virtualized /proc filesystem</h2> <p>You can prevent user from seeing processes of other users (via ps/top command) as well as special files in /proc file system by setting fs.proc_can_see_other_uid sysctl.</p> <p>To do that, edit /etc/sysctl.conf</p> <div class="language- extra-class"><pre class="language-text"><code>fs.proc_can_see_other_uid=0
fs.proc_super_gid=600
</code></pre></div><p>And do:</p> <div class="language- extra-class"><pre class="language-text"><code># sysctl -p
</code></pre></div><p>fs.proc_can_see_other_uid=0</p> <p>If fs.proc_can_see_other_uid is set to 0, users will not be able to see special files. If it is set to 1 - user will see other processes IDs in /proc filesystem.</p> <p>fs.proc_super_gid=XX</p> <p>The fs.proc_super_gid sets group ID which will see system files in /proc, add any users to that group so they will see all files in /proc. Usually needed by some monitoring users like nagios or zabbix and <a href="/cldetect/">cldetect utility</a> can configure few most commonly used monitoring software automatically.</p> <p>Virtualized /proc filesystem will only display following files (as well as directories for PIDs for the user) to unprivileged users:</p> <div class="language- extra-class"><pre class="language-text"><code>/proc/cpuinfo
/proc/version
/proc/stat
/proc/uptime
/proc/loadavg
/proc/filesystems
/proc/stat
/proc/cmdline
/proc/meminfo
/proc/mounts
/proc/tcp
/proc/tcp6
/proc/udp
/proc/udp6
/proc/assocs
/proc/raw
/proc/raw6
/proc/unix
/proc/dev
</code></pre></div><p>In <strong>lve-utils-2.1-3.2</strong> and later <em>/proc</em> can be remounted with &quot; <em>hidepid=2&quot;</em> option to enable additional protection for procfs. This remount is performed in lve_namespaces service.
This option is in sync with _ fs.proc_can_see_other_uid_ kernel parameter described above.
When <em>/etc/sysctl.conf</em> does not contain _ fs.proc_can_see_other_uid _ setting, the protection is off (procfs is remounted with <em>hidepid=0</em> option). In this case <em>fs.proc_super_gid</em> setting is ignored. Users are able to see full <em>/proc</em> including processes of other users on a server. This is a default behavior.</p> <p>If <em>/etc/sysctl.conf</em> contains <em>&quot;fs.proc_can_see_other_uid=1&quot;</em> setting, then /proc will be remounted with _&quot;hidepid=0&quot; _ option (disable <em>“hidepid”</em> protection for all users).
If <em>/etc/sysctl.conf</em> contains _ &quot;fs.proc_can_see_other_uid=0&quot; _ setting, then /proc will be remounted with <em>&quot;hidepid=2&quot;</em> option (enable <em>“hidepid”</em> protection for all users).
If <em>/etc/sysctl.conf</em> contains <em>&quot;fs.proc_can_see_other_uid=0&quot;</em> and <em>&quot;fs.proc_super_gid=$GID&quot;</em> settings, then <em>/proc</em> will be remounted with <em>&quot;hidepid=2, gid=$GID&quot;</em> options (enable <em>“hidepid”</em> for all users except users in group with gid $GID).</p> <p>To apply /etc/sysctl.conf changes, you should execute</p> <div class="language- extra-class"><pre class="language-text"><code>service lve_namespaces restart
</code></pre></div><p>Or</p> <div class="language- extra-class"><pre class="language-text"><code>/usr/share/cloudlinux/remount_proc.py
</code></pre></div><p>So, admin can prevent users from seeing processes of other users via _ “fs.proc_can_see_other_uid_ ” and _ &quot;fs.proc_super_gid&quot;_ settings in <em>/etc/sysctl.conf</em> , like earlier.</p> <p>Also, you can override this by specifying desired options for <em>/proc</em> in <em>/etc/fstab</em> .</p> <p>To disable hidepid, add to _ /etc/fstab_ the following:</p> <div class="language- extra-class"><pre class="language-text"><code>proc /proc proc defaults,hidepid=0,gid=0 0 0
</code></pre></div><p>Or you can specify desired hidepid and gid values explicitly:</p> <div class="language- extra-class"><pre class="language-text"><code>proc /proc proc defaults,hidepid=2,gid=clsupergid 0 0
</code></pre></div><p>You should execute</p> <div class="language- extra-class"><pre class="language-text"><code>mount -o remount /proc
</code></pre></div><p>to apply <em>/etc/fstab _ changes.
But we recommend to manage procfs mount options via _ /etc/sysctl.conf</em> as described above for backward compatibility.</p> <h2 id="securelinks"><a href="#securelinks" aria-hidden="true" class="header-anchor">#</a> SecureLinks</h2> <p>CloudLinux provides comprehensive protection against symbolic link attacks popular in shared hosting environment.</p> <p>The protection requires setting multiple kernel options to be enabled.</p> <h3 id="symlink-owner-match-protection"><a href="#symlink-owner-match-protection" aria-hidden="true" class="header-anchor">#</a> Symlink Owner Match Protection</h3> <p><strong><em>fs.enforce_symlinksifowner</em></strong></p> <p>To protect against symlink attack where attacker tricks Apache web server to read some other user PHP config files, or other sensitive file, enable:</p> <p><em>fs.enforce_symlinksifowner=1</em> .</p> <p>Setting this option will deny any process running under gid <em>fs.symlinkown_gid</em> to follow the symlink if owner of the link doesn’t match the owner of the target file.</p> <p>Defaults:</p> <div class="language- extra-class"><pre class="language-text"><code>fs.enforce_symlinksifowner = 1
fs.symlinkown_gid = 48
</code></pre></div><table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td></td> <td>do not check ownership</td></tr> <tr><td></td> <td>deny if ownership doesn’t match target, and process matches</td></tr></tbody></table> <p>When set to 1, processes with 48 will not be able to follow if they are owned by , but point to file owned .</p> <p>Please, note that is deprecated and can cause issues for the system operation.</p> <p><strong><em>fs.symlinkown_gid</em></strong></p> <p>On standard installation, is usually running under 48.
On servers, is running under user nobody, 99.</p> <p>To change of processes that cannot follow , edit the file , add the line:</p> <div class="language- extra-class"><pre class="language-text"><code>fs.symlinkown_gid = XX
</code></pre></div><p>And execute:</p> <div class="language- extra-class"><pre class="language-text"><code>$ sysctl -p
</code></pre></div><p>To disable owner match protection feature, set in , and execute</p> <div class="language- extra-class"><pre class="language-text"><code>$ sysctl -p
</code></pre></div><p>flag enables following the with root ownership. If , then does not verify the owned by</p> <p>For example, in the path is a , which leads to a process directory.  The owner is . When excludes this element from the verification. When , the verification will be performed, which could block the access to _ fd_ and cause violation of the web-site performance.</p> <p>It is recommended to set <em>/proc/sys/fs/global_root_enable=0</em> by default. If needed, set _ /proc/sys/fs/global_root_enable=1 _ to increase the level of protection.</p> <h3 id="link-traversal-protection"><a href="#link-traversal-protection" aria-hidden="true" class="header-anchor">#</a> Link Traversal Protection</h3> <p>is extremely powerful at stopping most information disclosure attacks, where a hacker could read sensitive files like .</p> <p>Yet, does not work in each and every situation. For example, on servers, it is not enabled in server, file manager and webmail, as well as some FTP servers don’t include proper change rooting.</p> <p>This allows an attacker to create symlink or hardlink to a sensitive file like and then use , filemanager, or webmail to read the content of that file.</p> <p>Starting with _ _ CL6 _ kernel 2.6.32-604.16.2.lve1.3.45_ , you can prevent such attacks by preventing user from creating symlinks and hardlinks to files that they don’t own.</p> <p>This is done by set following kernel options to 1:</p> <div class="language- extra-class"><pre class="language-text"><code>fs.protected_symlinks_create = 1
fs.protected_hardlinks_create = 1
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>fs.protected_symlinks_create = 0
fs.protected_hardlinks_create = 0
</code></pre></div><p>Then setup:</p> <div class="language- extra-class"><pre class="language-text"><code>fs.protected_symlinks_allow_gid = id_of_group_linksafe
fs.protected_hardlinks_allow_gid = id_of_group_linksafe
</code></pre></div><p>This is for example needed by PHP Selector to work (new versions of Alt-PHP can already correctly configure those settings).</p> <p>To manually adjust the settings, edit: <em>/etc/sysctl.d/cloudlinux-linksafe.conf</em>
and execute:</p> <div class="language- extra-class"><pre class="language-text"><code>sysctl -p /etc/sysctl.d/cloudlinux-linksafe.conf
</code></pre></div><p>or:</p> <div class="language- extra-class"><pre class="language-text"><code>sysctl --system
</code></pre></div><h2 id="ptrace-block"><a href="#ptrace-block" aria-hidden="true" class="header-anchor">#</a> ptrace Block</h2> <p>Starting with kernel 3.10.0-427.18.s2.lve1.4.21 ( 7) and 2.6.32-673.26.1.lve1.4.17 ( 6) we re-implemented to protect against family of vulnerabilities. It prevents end user from using any related functionality, including such commands as or .</p> <p>By default, doesn't prevent functionality.</p> <p>Defaults:</p> <div class="language- extra-class"><pre class="language-text"><code>kernel.user_ptrace = 1
kernel.user_ptrace_self = 1
</code></pre></div><p>The option disables functionality, option disables .</p> <p>To disable all functionality change both options to 0, add this section to :</p> <div class="language- extra-class"><pre class="language-text"><code>## CL. Disable ptrace for users
kernel.user_ptrace = 0
kernel.user_ptrace_self = 0
##
</code></pre></div><p>Apply changes with:</p> <div class="language- extra-class"><pre class="language-text"><code>$ sysctl -p
</code></pre></div><p>Different software could need different access to , you may need to change only one option to 0 to make them working. In this case, there will be only partial protection.</p> <h2 id="xen-xvda"><a href="#xen-xvda" aria-hidden="true" class="header-anchor">#</a> Xen XVDA</h2> <p>2.6.32 kernels have different mode of naming drives.</p> <p>By adding to kernel boot line in you will make sure no naming translation is done, and the drives will be identified as .</p> <p>By default, this option is set to 1 in the kernel, and drives are detected as .
This is needed only for CloudLinux 6 and kernels.</p> <h2 id="tpe-extension-deprecated"><a href="#tpe-extension-deprecated" aria-hidden="true" class="header-anchor">#</a> TPE Extension (deprecated)</h2> <p>The kernel supports feature out of the box. You can configure it using following files:</p> <p>·        /proc/sys/kernel/grsecurity/grsec_lock
·        /proc/sys/kernel/grsecurity/tpe
·        /proc/sys/kernel/grsecurity/tpe_gid
·        /proc/sys/kernel/grsecurity/tpe_restrict_all</p> <p>To enable feature in a standard way just add following to the end of your</p> <div class="language- extra-class"><pre class="language-text"><code>#GRsecurity 
kernel.grsecurity.tpe = 1 
kernel.grsecurity.tpe_restrict_all = 1 
kernel.grsecurity.grsec_lock = 1 
 
</code></pre></div><p>And do:</p> <div class="language- extra-class"><pre class="language-text"><code># sysctl -p
</code></pre></div><p>This feature was adopted from .</p> <h2 id="io"><a href="#io" aria-hidden="true" class="header-anchor">#</a> IO</h2> <p><strong>[lve1.2.29+]</strong></p> <p>When customer reaches
By defining</p> <p>This option is</p> <p>_For _</p> <p>To enable Limits latency and set it to 10 seconds:</p> <div class="language- extra-class"><pre class="language-text"><code># echo 10000 &gt; /sys/module/kmodlve/parameters/latency
</code></pre></div><p>To disable latency:</p> <div class="language- extra-class"><pre class="language-text"><code># echo 2000000000 &gt; /sys/module/kmodlve/parameters/latency
</code></pre></div><p>It is possible to set, for example, 1000 as a permanent value. To do so, create a file with the following content:</p> <p>_For _</p> <p>To enable Limits latency and set it to 10 seconds:</p> <div class="language- extra-class"><pre class="language-text"><code># echo 10000 &gt; /sys/module/iolimits/**parameters/latency
</code></pre></div><p>To disable latency:</p> <div class="language- extra-class"><pre class="language-text"><code># echo 2000000000 &gt; /sys/module/iolimits/**parameters/latency
</code></pre></div><h2 id="hybrid-kernel"><a href="#hybrid-kernel" aria-hidden="true" class="header-anchor">#</a> Hybrid Kernel</h2> <p>6 Hybrid Kernel is 7 (3.10.0) kernel compiled for</p> <p>Please find information on the main features of 3.10 kernel branch on the links:</p> <p><a href="https://kernelnewbies.org/Linux_3.10#head-e740f930dfd021616cc42e8abf21c79d0b07e217" target="_blank" rel="noopener noreferrer">https://kernelnewbies.org/Linux_3.10#head-e740f930dfd021616cc42e8abf21c79d0b07e217<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.kernel.org/pub/linux/kernel/v3.0/ChangeLog-3.10.1" target="_blank" rel="noopener noreferrer">https://www.kernel.org/pub/linux/kernel/v3.0/ChangeLog-3.10.1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>How to migrate from the normal to hybrid channel:</p> <ol><li><p>Update from production</p></li> <li><p>Run script.</p></li> <li><p>Reboot after script execution is completed.</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>yum update rhn-client-tools
normal-to-hybrid
reboot
</code></pre></div><p>How to migrate from hybrid to the normal channel:</p> <ol><li><p>Run script.</p></li> <li><p>Reboot after script execution is completed.</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>hybrid-to-normal
reboot
</code></pre></div><p><strong>Known limitations and issues</strong> :</p> <ol><li><p>We do not remove Hybrid kernel after migration from Hybrid to the normal channel, but we remove package which is needed to boot Hybrid kernel. This is because 6 does not allow to remove the package of currently running kernel. Proper removal procedure will be implemented, but for now, we should warn users <em>not to boot Hybrid kernel if they have migrated to normal channel</em> .</p></li> <li><p>Kernel module signature isn't checking for now, as 3.10 kernel is using x509 certificates to generate keys and CL6 cannot detect signatures created in such way. The solution will be implemented.</p></li></ol> <h2 id="reading"><a href="#reading" aria-hidden="true" class="header-anchor">#</a> Reading</h2> <p>CloudLinux kernel provides real time usage data in file.</p> <p>All the statistics can be read from that file in real time. Depending on your kernel version you will get either Version 6 of the file, or version 4 of the file.
You can detect the version by reading the first line of the file. It should look like:</p> <p>4:LVE... for version 4</p> <p>First line presents headers for the data.
Second line shows default limits for the server, with all other values being 0.
The rest of the lines present limits &amp; usage data on per bases.</p> <p>Version 6 (CL6 &amp; hybrid kernels):</p> <div class="language- extra-class"><pre class="language-text"><code>6:LVE        EP        lCPU        lIO        CPU        MEM        IO        lMEM        lEP        nCPU        fMEM        fEP        lMEMPHY        lCPUW        lNPROC        MEMPHY        fMEMPHY        NPROC        fNPROC
0        0        25        1024        0        0        0        262144        20        1        0        0        262144        100        0        0        0        00
300        0        25        1024        1862407        0        0        262144        20        1        0        0        262144        100        0        31        000
</code></pre></div><p>Version 4 (CL 5 kernel):</p> <div class="language- extra-class"><pre class="language-text"><code>4:LVE        EP        lCPU        lIO        CPU        MEM        IO        lMEM        lEP        nCPU        fMEM        fEP
0        0        25        25        0        0        0        262144        20        1        0        0
300        0        25        25        15103019        0        0        262144        20        1        0        0
</code></pre></div><table><thead><tr><th></th> <th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><strong>Label</strong></td> <td><strong>Description</strong></td> <td><strong>Value</strong></td> <td><strong>Supported versions</strong></td></tr> <tr><td></td> <td></td> <td>number</td> <td></td></tr> <tr><td></td> <td>Number of</td> <td>number</td> <td></td></tr> <tr><td></td> <td>Limit</td> <td>% relative to total</td> <td></td></tr> <tr><td></td> <td>limits for CL6 or priority for CL5</td> <td>KB/s for v6, from 1 to 100 for v4</td> <td></td></tr> <tr><td></td> <td>usage since reboot</td> <td>in nanoseconds for v6, hertz for v4</td> <td></td></tr> <tr><td></td> <td>Virtual memory usage</td> <td>number of 4k pages</td> <td></td></tr> <tr><td></td> <td>usage</td> <td>KB/s for v6, 0 for v4</td> <td></td></tr> <tr><td></td> <td>Virtual memory limit</td> <td>number of 4k pages</td> <td></td></tr> <tr><td></td> <td>limit</td> <td>number</td> <td></td></tr> <tr><td></td> <td>Number of cores limit</td> <td>number of cores</td> <td></td></tr> <tr><td></td> <td>faults</td> <td>number of faults</td> <td></td></tr> <tr><td></td> <td>faults</td> <td>number of faults</td> <td>v6+</td></tr> <tr><td></td> <td>Physical memory limit</td> <td>number</td> <td>v6+</td></tr> <tr><td></td> <td>weight (not used)</td> <td>from 1 to 100</td> <td>v6+</td></tr> <tr><td></td> <td>limit</td> <td>number</td> <td>v6+</td></tr> <tr><td></td> <td>Physical memory usage</td> <td>number of 4k pages</td> <td>v6+</td></tr> <tr><td></td> <td>Physical memory faults</td> <td>number of faults</td> <td>v6+</td></tr> <tr><td></td> <td></td> <td>number</td> <td>v6+</td></tr> <tr><td></td> <td>faults</td> <td>number of faults</td> <td>v6+</td></tr> <tr><td></td> <td>operations since reboot</td> <td>number</td> <td>v8+</td></tr></tbody></table> <h2 id="flashcache"><a href="#flashcache" aria-hidden="true" class="header-anchor">#</a> flashcache</h2> <p>_* Available only for x86_64, _</p> <p>is a module originally written and released by and ) in April of 2010. It is a kernel module that allows Writethrough caching of a drive on another drive. This is most often used for caching a rotational drive on a smaller solid-state drive for performance reasons. This gives you the speed of an and the size of a standard rotational drive for recently cached files. originally wrote the module to speed up database , but it is easily extended to any .</p> <p>To install on 6 &amp; Hybrid servers:</p> <div class="language- extra-class"><pre class="language-text"><code>$ yum install flashcache
</code></pre></div><p>More info on : <a href="https://github.com/facebook/flashcache/" target="_blank" rel="noopener noreferrer">https://github.com/facebook/flashcache/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>has a good page explaining how to use :
<a href="https://wiki.archlinux.org/index.php/Flashcache" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/Flashcache<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="oom-killer"><a href="#oom-killer" aria-hidden="true" class="header-anchor">#</a> OOM Killer</h2> <p>When reaches its memory limit, the processes inside that are killed by and appropriate message is written to . When any hits huge number of memory limits in short period of time, then could cause system overload. Starting from kernel 2.6.32-673.26.1.lve1.4.15 ( 6) and from kernel 3.10.0-427.18.2.lve1.4.14 ( 7) heavy could be disabled. If so - lightweight will be used instead.</p> <p>By default is enabled, to disable it please run:</p> <p>_For _ :</p> <div class="language- extra-class"><pre class="language-text"><code># echo 1 &gt; /proc/sys/ubc/ubc_oom_disable
</code></pre></div><p>Also, add the following to file to apply the same during boot:</p> <div class="language- extra-class"><pre class="language-text"><code>ubc.ubc_oom_disable=1
</code></pre></div><p>_For _</p> <div class="language- extra-class"><pre class="language-text"><code># echo 1 &gt; /proc/sys/kernel/memcg_oom_disable
</code></pre></div><p>Also, add the following to _ _ file to apply the same during boot:</p> <div class="language- extra-class"><pre class="language-text"><code>kernel.memcg_oom_disable=1
</code></pre></div><h2 id="file-system-quotas"><a href="#file-system-quotas" aria-hidden="true" class="header-anchor">#</a> File System Quotas</h2> <p>In file system, the process with enabled capability is not checked on the quota exceeding by default. It allows userland utilities and to operate without fails even if a user exceeds a quota.</p> <p>To disable quota checking in file system set option to 1 using the following command:</p> <div class="language- extra-class"><pre class="language-text"><code># echo 1 &gt; /proc/sys/fs/xfs/cap_res_quota_disable
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/inodes_limits/" class="prev">
          inodes
        </a></span> <span class="next"><a href="/apache_mod_lsapi/">
          Apache mod_lsapi
        </a>
        →
      </span></p></div> </div> <div class="footer" data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.com" data-v-ac83a848><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-ac83a848></a></div> <div data-v-ac83a848>2018. CloudLinux Inc</div> <div data-v-ac83a848><div data-v-ac83a848><a href="#" target="_blank" data-v-ac83a848>How to</a></div><div data-v-ac83a848><a href="#" target="_blank" data-v-ac83a848>Getting started</a></div><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-ac83a848>Contact support</a></div><div data-v-ac83a848><a href="https://www.cloudlinux.com/blog" target="_blank" data-v-ac83a848>Blog</a></div></div> <div class="social" data-v-ac83a848><span data-v-ac83a848>Stay in touch</span> <a href="https://www.facebook.com/cloudlinux/" target="_blank" data-v-ac83a848><img src="/fb.svg" data-v-ac83a848></a><a href="https://twitter.com/cloudlinuxos/" target="_blank" data-v-ac83a848><img src="/tw.svg" data-v-ac83a848></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-ac83a848><img src="/in.svg" data-v-ac83a848></a><a href="https://www.youtube.com/channel/UCZ3YMHWnMP7TaxlXVay5-aw" target="_blank" data-v-ac83a848><img src="/ytube.svg" data-v-ac83a848></a></div></div> <!----></div></div>
    <script src="/assets/js/app.0abf6f2a.js" defer></script><script src="/assets/js/17.1fdd51cc.js" defer></script>
  </body>
</html>
